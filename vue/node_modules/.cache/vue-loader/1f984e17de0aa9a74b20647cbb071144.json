{"remainingRequest":"C:\\Users\\lemos\\OneDrive\\Documentos\\My Web Sites\\7.3.0\\vue\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\lemos\\OneDrive\\Documentos\\My Web Sites\\7.3.0\\vue\\src\\views\\ordemCompra\\ViewOrdemCompraEdit.vue?vue&type=style&index=0&id=1c72438c&scoped=true&lang=css&","dependencies":[{"path":"C:\\Users\\lemos\\OneDrive\\Documentos\\My Web Sites\\7.3.0\\vue\\src\\views\\ordemCompra\\ViewOrdemCompraEdit.vue","mtime":1680609356653},{"path":"C:\\Users\\lemos\\OneDrive\\Documentos\\My Web Sites\\7.3.0\\vue\\node_modules\\css-loader\\dist\\cjs.js","mtime":1683229778387},{"path":"C:\\Users\\lemos\\OneDrive\\Documentos\\My Web Sites\\7.3.0\\vue\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1683229781560},{"path":"C:\\Users\\lemos\\OneDrive\\Documentos\\My Web Sites\\7.3.0\\vue\\node_modules\\postcss-loader\\src\\index.js","mtime":1683229779724},{"path":"C:\\Users\\lemos\\OneDrive\\Documentos\\My Web Sites\\7.3.0\\vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1683229777571},{"path":"C:\\Users\\lemos\\OneDrive\\Documentos\\My Web Sites\\7.3.0\\vue\\node_modules\\vue-loader\\lib\\index.js","mtime":1683229780390}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoNCi50aXR1bG8gew0KICBmb250LXdlaWdodDogODAwOw0KfQ0K"},{"version":3,"sources":["ViewOrdemCompraEdit.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAw9BA;AACA;AACA","file":"ViewOrdemCompraEdit.vue","sourceRoot":"src/views/ordemCompra","sourcesContent":["<template>\r\n  <div class=\"flex-column mx-10\" style=\"width: 100%; overflow: auto\">\r\n    <top-section :nameRoute=\"nameRoute\"></top-section>\r\n    <v-alert\r\n      type=\"success\"\r\n      transition=\"slide-y-transition\"\r\n      dismissible\r\n      v-show=\"alertSuccessPurchase\"\r\n      dense\r\n      width=\"100%\"\r\n      >{{ alertSuccessPurchaseText }}</v-alert\r\n    >\r\n    <v-alert\r\n      type=\"error\"\r\n      transition=\"slide-y-transition\"\r\n      dismissible\r\n      v-show=\"alertError\"\r\n      dense\r\n      width=\"100%\"\r\n      >{{ alertErrorText }}</v-alert\r\n    >\r\n    <div class=\"d-flex\">\r\n      <h2 class=\"asia-neutral--text text--var-1 mr-2\">\r\n        {{ $route.meta.title }}\r\n      </h2>\r\n      <h2 class=\"asia-neutral--text text--var-1 mr-4\">\r\n        {{ addZeroes(purchaseOrder.id, 4) }}\r\n      </h2>\r\n\r\n      <v-chip\r\n        :color=\"\r\n          purchaseOrder.purchaseOrderSituation.color == '#FFFFFF'\r\n            ? 'black'\r\n            : purchaseOrder.purchaseOrderSituation.color\r\n        \"\r\n        class=\"pa-4\"\r\n        outlined\r\n        style=\"font-weight: 500\"\r\n      >\r\n        <Loading\r\n          class=\"pa-2 align-self-center\"\r\n          v-if=\"purchaseOrder.purchaseOrderSituation == null\"\r\n          :size=\"20\"\r\n        />\r\n        {{ purchaseOrder.purchaseOrderSituation.description }}\r\n      </v-chip>\r\n    </div>\r\n\r\n    <MissingPermissionModal \r\n      ref=\"missingPermissionModal\"\r\n    />\r\n\r\n    <ModalChangeProforma\r\n      ref=\"changeProformaDialog\"\r\n      @confirmChange=\"savePurchaseOrder\"\r\n    ></ModalChangeProforma>\r\n\r\n    <!-- Modal adicionar Pagamento-->\r\n    <modal-add-and-update-payments\r\n      :currency=\"currency\"\r\n      v-model=\"modalAddPayments\"\r\n      @getPayments=\"listPagamentos\"\r\n      @setSuccessMessage=\"\r\n        setSuccessMessage('Pagamento alterado com sucesso!', 3)\r\n      \"\r\n    ></modal-add-and-update-payments>\r\n\r\n    <!-- Modal adicionar Material-->\r\n    <modal-add-and-update-materials\r\n      ref=\"modalAddMaterial\"\r\n      @setListToFalse=\"setListsToFalse\"\r\n      @setListsToTrue=\"setListsToTrue\"\r\n      @setSuccessMessage=\"\r\n        setSuccessMessage('Material adicionado com sucesso!', 2)\r\n      \"\r\n      @reloadButton=\"reloadAddButton()\"\r\n      :currency=\"currency\"\r\n      :isDistribution=\"isDistribution\"\r\n      :purchaseOrderId=\"purchaseOrder.id\"\r\n      :proformaId=\"purchaseOrder.proformaId\"\r\n    ></modal-add-and-update-materials>\r\n\r\n    <Loading\r\n      v-if=\"loadingComponent\"\r\n      class=\"d-flex mt-5\"\r\n      :visible=\"loadingComponent\"\r\n      :size=\"80\"\r\n    ></Loading>\r\n\r\n    <div class=\"pa-2\" v-else>\r\n      <v-expansion-panels>\r\n        <v-expansion-panel class=\"mb-3 rounded-lg elevation-2\">\r\n          <v-expansion-panel-header class=\"asia-neutral--text\">\r\n            <h1 style=\"font-size: 14px\">INFORMAÇÕES GERAIS</h1>\r\n          </v-expansion-panel-header>\r\n\r\n          <v-expansion-panel-content>\r\n            <v-form ref=\"formPurchase\">\r\n              <div class=\"d-flex flex-column justify-space-between\">\r\n                <div class=\"d-flex\" style=\"width: 100%\">\r\n                  <v-text-field\r\n                    :disabled=\"!editPermission\"\r\n                    label=\"Pedido de Compra (Opcional)\"\r\n                    class=\"mr-4\"\r\n                    clearable\r\n                    v-model=\"purchaseOrder.orderPurchase\"\r\n                    style=\"width: 33%\"\r\n                    :loading=\"loading\"\r\n                  ></v-text-field>\r\n\r\n                  <v-input\r\n                    class=\"mr-4\"\r\n                    :messages=\"verifyOrderType(purchaseOrder.purchaseOrderType)\"\r\n                    style=\"width: 33%\"\r\n                    label=\"Tipo de Ordem de Compra\"\r\n                    :loading=\"loading\"\r\n                  ></v-input>\r\n\r\n                  <v-input\r\n                    :messages=\"verifyFreightType(purchaseOrder.freightType)\"\r\n                    style=\"width: 33%\"\r\n                    label=\"Tipo de Frete\"\r\n                    :loading=\"loading\"\r\n                  ></v-input>\r\n                </div>\r\n\r\n                <div class=\"d-flex\" style=\"width: 100%\">\r\n                  <v-select\r\n                    v-if=\"hasPermission($PermissionNames.permissionCategorySituationSee)\"\r\n                    :disabled=\"!editPermission\"\r\n                    :rules=\"[rules.required]\"\r\n                    :items=\"categorySituationItems\"\r\n                    label=\"Situação da Ordem de Compra\"\r\n                    v-model=\"purchaseOrder.purchaseOrderSituationId\"\r\n                    :loading=\"loading\"\r\n                    class=\"mr-4\"\r\n                    clearable\r\n                    style=\"width: 33%\"\r\n                  ></v-select>\r\n                  <v-text-field\r\n                    v-else\r\n                    v-model=\"purchaseOrder.purchaseOrderSituation.description\"\r\n                    :loading=\"loading\"\r\n                    disabled\r\n                    label=\"Situação da Ordem de Compra\"\r\n                    class=\"mr-4\"\r\n                    style=\"width: 33%\"\r\n                  >\r\n                  </v-text-field>\r\n\r\n                  <DatePicker\r\n                    v-model=\"purchaseOrder.closingDate\"\r\n                    :disabled=\"!editPermission\"\r\n                    label=\"Fechamento Pedido (opcional)\"\r\n                    class=\"mr-4\"\r\n                    style=\"width: 33%\"\r\n                  ></DatePicker>\r\n\r\n                  <div v-if=\"isDistribution\">\r\n                    <AutoCompleteFilterAsync\r\n                      v-if=\"hasPermission($PermissionNames.permissionCustomerSee)\"\r\n                      :disabled=\"!editPermission\"\r\n                      :getStore=\"getCustomer\"\r\n                      :searchStore=\"loadCustomer\"\r\n                      displayText=\"corporateName\"\r\n                      v-model=\"purchaseOrder.customerId\"\r\n                      label=\"Cliente\"\r\n                      placeholder=\"Digite 3 caracteres\"\r\n                    ></AutoCompleteFilterAsync>\r\n                    <v-text-field\r\n                      v-else\r\n                      v-model=\"purchaseOrder.customerName\"\r\n                      disabled\r\n                      label=\"Cliente\"\r\n                    >\r\n                    </v-text-field>\r\n                  </div>\r\n\r\n                  <v-select\r\n                    v-else\r\n                    v-model=\"purchaseOrder.currency\"\r\n                    :disabled=\"!editPermission\"\r\n                    :rules=\"[rules.required]\"\r\n                    label=\"Moeda\"\r\n                    clearable\r\n                    :loading=\"loading\"\r\n                    :items=\"[\r\n                      { text: 'Dólar - USD', value: 1 },\r\n                      { text: 'Real - R$', value: 2 },\r\n                    ]\"\r\n                    class=\"mb-4\"\r\n                    style=\"width: 33%\"\r\n                    validate-on-blur\r\n                  ></v-select>\r\n                </div>\r\n\r\n                <div v-if=\"!isDistribution\" class=\"d-flex\" style=\"width: 100%\">\r\n                  <AutoCompleteFilterAsync\r\n                    v-if=\"hasPermission($PermissionNames.permissionProformaSee)\"\r\n                    :disabled=\"!editPermission\"\r\n                    :searchStore=\"loadProformas\"\r\n                    :getStore=\"getProforma\"\r\n                    displayText=\"nome\"\r\n                    v-model=\"purchaseOrder.proformaId\"\r\n                    label=\"Proforma\"\r\n                    placeholder=\"Digite 3 caracteres\"\r\n                    :rules=\"[rules.required]\"\r\n                    class=\"mr-4\"\r\n                    style=\"width: 33%\"\r\n                  />\r\n                  <v-text-field\r\n                    v-else\r\n                    v-model=\"purchaseOrder.proformaName\"\r\n                    disabled\r\n                    label=\"Proforma\"\r\n                    class=\"mr-4\"\r\n                    style=\"width: 33%\"\r\n                    :rules=\"[rules.required]\"\r\n                  >\r\n                  </v-text-field>\r\n\r\n                  <AutoCompleteFilterAsync\r\n                    v-if=\"hasPermission($PermissionNames.permissionCustomerSee)\"\r\n                    :disabled=\"!editPermission\"\r\n                    :searchStore=\"loadCustomer\"\r\n                    :getStore=\"getCustomer\"\r\n                    displayText=\"corporateName\"\r\n                    v-model=\"purchaseOrder.customerId\"\r\n                    label=\"Cliente\"\r\n                    placeholder=\"Digite 3 caracteres\"\r\n                    style=\"width: 67%\"\r\n                    :rules=\"[rules.required]\"\r\n                  />\r\n                  <v-text-field\r\n                    v-else\r\n                    v-model=\"purchaseOrder.customerName\"\r\n                    disabled\r\n                    label=\"Cliente\"\r\n                    style=\"width: 67%\"\r\n                  >\r\n                  </v-text-field>\r\n                </div>\r\n\r\n                <div class=\"d-flex mb-4 align-baseline\" style=\"width: 100%\">\r\n                  <v-file-input\r\n                    class=\"mr-4\"\r\n                    label=\"Anexos\"\r\n                    :loading=\"loading\"\r\n                    :disabled=\"!editPermission\"\r\n                    accept=\"image/png, image/jpeg, application/pdf\"\r\n                    hint=\"Formatos permitidos: JPG, PNG, PDF. Tamanho máximo: 25 MB\"\r\n                    persistent-hint\r\n                    clearable\r\n                    v-model=\"purchaseOrder.files\"\r\n                    append-icon=\"mdi-download\"\r\n                    @click:append=\"download\"\r\n                    multiple\r\n                    @change=\"validateLength(purchaseOrder.files)\"\r\n                  >\r\n                    <template v-slot:selection=\"{ index, text }\">\r\n                      <v-chip\r\n                        v-if=\"index < 1 && purchaseOrder.files.length == 1\"\r\n                        color=\"red accent-4\"\r\n                        dark\r\n                        label\r\n                        small\r\n                      >\r\n                        {{ text }}\r\n                      </v-chip>\r\n\r\n                      <span\r\n                        v-else-if=\"index === 1\"\r\n                        class=\"text-overline grey--text text--darken-3 mx-2\"\r\n                      >\r\n                        +{{ purchaseOrder.files.length }} Arquivo(s)\r\n                      </span>\r\n                    </template></v-file-input\r\n                  >\r\n\r\n                  <v-btn\r\n                    v-if=\"editPermission\"\r\n                    rounded\r\n                    class=\"asia-red white--text\"\r\n                    :loading=\"loadingBtnSave\"\r\n                    @click=\"verifyAndSave\"\r\n                    >SALVAR</v-btn\r\n                  >\r\n                </div>\r\n              </div>\r\n            </v-form>\r\n          </v-expansion-panel-content>\r\n        </v-expansion-panel>\r\n      </v-expansion-panels>\r\n\r\n      <v-expansion-panels>\r\n        <v-expansion-panel class=\"mb-3 rounded-lg elevation-2\">\r\n          <v-alert\r\n            type=\"success\"\r\n            transition=\"slide-y-transition\"\r\n            dismissible\r\n            v-show=\"alertSuccessMaterial\"\r\n            dense\r\n            width=\"100%\"\r\n            >{{ alertSuccessMaterialText }}</v-alert\r\n          >\r\n          <v-expansion-panel-header class=\"asia-neutral--text\">\r\n            <h1 style=\"font-size: 14px\">MATERIAIS</h1>\r\n          </v-expansion-panel-header>\r\n\r\n          <v-expansion-panel-content>\r\n            <Loading\r\n              v-if=\"loadingComponent\"\r\n              class=\"mt-4 mb-4\"\r\n              :visible=\"loadingComponent\"\r\n              :size=\"80\"\r\n            ></Loading>\r\n\r\n            <materiais\r\n              v-else\r\n              :currency=\"currency\"\r\n              :isDistribution=\"isDistribution\"\r\n              :purchaseOrder=\"purchaseOrder\"\r\n              :getMaterials=\"listMaterials\"\r\n              @setListToFalse=\"setListsToFalse\"\r\n              @setSuccessOnRemoveMessage=\"\r\n                setSuccessMessage('Material removido com sucesso!', 2)\r\n              \"\r\n              @setSuccessMessage=\"\r\n                setSuccessMessage('Material alterado com sucesso!', 2)\r\n              \"\r\n              :isDelivery=\"setDelivery\"\r\n              @loadMaterialList=\"setListsToTrue\"\r\n              @addMaterial=\"checkPermissionAndAddMaterial\"\r\n              @reloadButton=\"reloadAddButton()\"\r\n            ></materiais>\r\n          </v-expansion-panel-content>\r\n        </v-expansion-panel>\r\n      </v-expansion-panels>\r\n\r\n      <v-expansion-panels>\r\n        <v-expansion-panel\r\n          class=\"mb-3 rounded-lg elevation-2\"\r\n          v-if=\"!isDistribution\"\r\n        >\r\n          <v-alert\r\n            type=\"success\"\r\n            transition=\"slide-y-transition\"\r\n            dismissible\r\n            v-show=\"alertSuccessBoardingMaterial\"\r\n            dense\r\n            width=\"100%\"\r\n            >{{ alertSuccessBoardingMaterialText }}</v-alert\r\n          >\r\n          <v-expansion-panel-header class=\"asia-neutral--text\">\r\n            <h1 style=\"font-size: 14px\">EMBARQUE DA PROFORMA</h1>\r\n          </v-expansion-panel-header>\r\n\r\n          <v-expansion-panel-content>\r\n            <Loading\r\n              v-if=\"loadingComponent\"\r\n              class=\"mt-4 mb-4\"\r\n              :visible=\"loadingComponent\"\r\n              :size=\"80\"\r\n            ></Loading>\r\n            <div v-else>\r\n              <div\r\n                v-if=\"\r\n                  !purchaseOrder.boardings ||\r\n                  purchaseOrder.boardings.length == 0\r\n                \"\r\n                class=\"my-1 mt-4 pa-4 d-flex align-center\"\r\n                style=\"\r\n                  width: 100%;\r\n                  height: 15px;\r\n                  color: white;\r\n                  background: #2196f3;\r\n                  border-radius: 5px;\r\n                \"\r\n              >\r\n                <v-icon class=\"ml-2 mr-2\" color=\"white\"\r\n                  >mdi-alert-circle\r\n                </v-icon>\r\n                <span\r\n                  >Proforma não vinculada ou sem embarques cadastrados\r\n                </span>\r\n              </div>\r\n              <EmbarqueProforma\r\n                v-else\r\n                :currency=\"currency\"\r\n                :boardings.sync=\"purchaseOrder.boardings\"\r\n                @setSuccessMessage=\"\r\n                  setSuccessMessage(\r\n                    'Material do embarque alterado com sucesso!',\r\n                    4\r\n                  )\r\n                \"\r\n              />\r\n            </div>\r\n          </v-expansion-panel-content>\r\n        </v-expansion-panel>\r\n      </v-expansion-panels>\r\n\r\n      <v-expansion-panels>\r\n        <v-expansion-panel class=\"mb-3 rounded-lg elevation-2\">\r\n          <v-alert\r\n            type=\"success\"\r\n            transition=\"slide-y-transition\"\r\n            dismissible\r\n            v-show=\"alertSuccessPayments\"\r\n            dense\r\n            width=\"100%\"\r\n            >{{ alertSuccessPaymentsText }}</v-alert\r\n          >\r\n          <v-expansion-panel-header class=\"asia-neutral--text\">\r\n            <h1 style=\"font-size: 14px\">FINANCEIRO</h1>\r\n          </v-expansion-panel-header>\r\n\r\n          <v-expansion-panel-content>\r\n            <Loading\r\n              v-if=\"loadingComponent\"\r\n              class=\"mt-4 mb-4\"\r\n              :visible=\"loadingComponent\"\r\n              :size=\"80\"\r\n            ></Loading>\r\n\r\n            <financeiro\r\n              v-else\r\n              :listPayments=\"listPayments\"\r\n              :currency=\"currency\"\r\n              @setSuccessMessage=\"\r\n                setSuccessMessage('Pagamento alterado com sucesso!', 3)\r\n              \"\r\n              @addPayment=\"checkPermissionAndAddPayment\"\r\n              @setListsToTrue=\"setListsToTrue\"\r\n              @setListToFalse=\"setListsToFalse\"\r\n            ></financeiro>\r\n          </v-expansion-panel-content>\r\n        </v-expansion-panel>\r\n      </v-expansion-panels>\r\n\r\n      <v-expansion-panels>\r\n        <v-expansion-panel\r\n          class=\"mb-3 rounded-lg elevation-2\"\r\n          v-if=\"setDelivery\"\r\n        >\r\n          <v-alert\r\n            type=\"success\"\r\n            transition=\"slide-y-transition\"\r\n            dismissible\r\n            v-show=\"alertSuccess\"\r\n            dense\r\n            width=\"100%\"\r\n            >{{ alertSuccessText }}</v-alert\r\n          >\r\n          <v-expansion-panel-header class=\"d-flex asia-neutral--text\">\r\n            <h1 style=\"font-size: 14px\">ENTREGAS</h1>\r\n          </v-expansion-panel-header>\r\n\r\n          <v-expansion-panel-content>\r\n            <Loading\r\n              v-if=\"loadingComponent\"\r\n              class=\"mt-4 mb-4\"\r\n              :visible=\"loadingComponent\"\r\n              :size=\"80\"\r\n            ></Loading>\r\n            <entregas\r\n              v-else\r\n              style=\"height: auto\"\r\n              @success=\"setSuccessMessage\"\r\n              :listDeliveries=\"listDeliveries\"\r\n              @setDeliveryListToFalse=\"listDeliveries = false\"\r\n              :currency=\"currency\"\r\n              :isDistribution=\"isDistribution\"\r\n            ></entregas>\r\n          </v-expansion-panel-content>\r\n        </v-expansion-panel>\r\n\r\n        <v-expansion-panel\r\n          class=\"mb-3 rounded-lg elevation-2\"\r\n          v-if=\"!setDelivery\"\r\n        >\r\n          <v-alert\r\n            type=\"success\"\r\n            transition=\"slide-y-transition\"\r\n            dismissible\r\n            v-show=\"alertSuccess\"\r\n            dense\r\n            width=\"100%\"\r\n            >{{ alertSuccessText }}\r\n          </v-alert>\r\n\r\n          <v-alert\r\n            type=\"error\"\r\n            transition=\"slide-y-transition\"\r\n            dismissible\r\n            v-show=\"errorAlertColeta\"\r\n            dense\r\n            width=\"100%\"\r\n            >{{ errorTextColeta }}\r\n          </v-alert>\r\n\r\n          <v-expansion-panel-header class=\"asia-neutral--text\">\r\n            <h1 style=\"font-size: 14px\">COLETAS</h1>\r\n          </v-expansion-panel-header>\r\n\r\n          <v-expansion-panel-content>\r\n            <Loading\r\n              v-if=\"loadingComponent\"\r\n              class=\"mt-4 mb-4\"\r\n              :visible=\"loadingComponent\"\r\n              :size=\"80\"\r\n            ></Loading>\r\n            <coletas\r\n              v-else\r\n              style=\"height: auto\"\r\n              @success=\"setSuccessMessage('Coleta alterada com sucesso!')\"\r\n              @deleteSucess=\"messageDeleteColeta()\"\r\n              @error=\"setErrorMessage\"\r\n              :listCollections=\"listCollections\"\r\n              @setDeliveryListToFalse=\"listCollections = false\"\r\n              :currency=\"currency\"\r\n              :isDistribution=\"isDistribution\"\r\n            ></coletas>\r\n          </v-expansion-panel-content>\r\n        </v-expansion-panel>\r\n      </v-expansion-panels>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport TopSection from \"@/components/TopSection.vue\";\r\nimport Financeiro from \"./financeiro.vue\";\r\nimport Materiais from \"./materiais.vue\";\r\nimport Entregas from \"./entregas/entregas.vue\";\r\nimport Coletas from \"./entregas/coletas.vue\";\r\nimport DatePicker from \"@/components/DatePicker\";\r\nimport validationRules from \"../../mixins/validationRules\";\r\nimport { createNamespacedHelpers } from \"vuex\";\r\nimport ModalChangeProforma from \"./ModalChangeProforma.vue\";\r\nimport ModalAddAndUpdateMaterials from \"./ModalAddAndUpdateMaterials.vue\";\r\nimport AutoCompleteFilterAsync from \"@/components/AutoCompleteFilterAsync\";\r\nimport ModalAddAndUpdatePayments from \"./ModalAddAndUpdatePayments.vue\";\r\nimport { toBase64 } from \"@/lib/helpers/base64\";\r\nimport tiposCategorias from \"@/lib/enumTiposCategorias.js\";\r\nimport enumIncotermPart from \"@/lib/enumIncotermPart.js\";\r\nimport enumPurchaseOrderType from \"@/lib/enumPurchaseOrderType.js\";\r\nimport EmbarqueProforma from \"./embarqueProforma/embarqueProforma.vue\";\r\nimport Loading from \"../../components/Loading.vue\";\r\nimport MissingPermissionModal from \"@/components/MissingPermissionModal.vue\";\r\n\r\nconst moduleProforma = createNamespacedHelpers(\"ModuleProformas\");\r\nconst moduleOrdemDeCompra = createNamespacedHelpers(\"ModuleOrdemDeCompra\");\r\nconst moduleClientes = createNamespacedHelpers(\"ModuleClientes\");\r\nconst moduleCategoriaSituacao = createNamespacedHelpers(\r\n  \"ModuleCategoriaSituacao\"\r\n);\r\nexport default {\r\n  data: () => ({\r\n    alertError: null,\r\n    alertErrorText: null,\r\n    valid: null,\r\n    listMaterials: null,\r\n    purchaseMaterials: {},\r\n    modalAddPayments: null,\r\n    listPayments: null,\r\n    alertSuccessBoardingMaterialText: null,\r\n    alertSuccessBoardingMaterial: null,\r\n    loadingComponent: null,\r\n    purchaseOrder: {\r\n      id: 0,\r\n      purchaseOrderSituation: {},\r\n      orderPurchase: null,\r\n      purchaseOrderDistributionMaterial: null,\r\n      files: null,\r\n    },\r\n    originalProformaId: null,\r\n    item: 1,\r\n    nameRoute: \"ViewOrdemCompra\",\r\n    categorySituationItems: [],\r\n    tipoFrete: \"CIF\",\r\n    modalAddPagamento: false,\r\n    alertSuccessPurchaseText: null,\r\n    alertSuccessPurchase: null,\r\n    dataRealizada: \"\",\r\n    dataPrevista: \"\",\r\n    entregas: false,\r\n    coletas: false,\r\n    alertSuccessText: null,\r\n    alertSuccess: null,\r\n    fechamentoPedido: \"\",\r\n    loading: null,\r\n    listDeliveries: null,\r\n    listCollections: null,\r\n    loadingBtnSave: null,\r\n    setDelivery: null,\r\n    alertSuccessMaterial: null,\r\n    alertSuccessMaterialText: null,\r\n    alertSuccessPaymentsText: null,\r\n    alertSuccessPayments: null,\r\n    customerData: [],\r\n    codePurchase: null,\r\n    filesToDownload: null,\r\n    errorAlertColeta: false,\r\n    errorTextColeta: \"\",\r\n    tableLoading: false,\r\n  }),\r\n\r\n  methods: {\r\n    ...moduleCategoriaSituacao.mapActions({ getByType: \"getByType\" }),\r\n    ...moduleProforma.mapActions({\r\n      getAllProformaSearch: \"getAllSearch\",\r\n      getProformaByCode: \"getByCode\",\r\n    }),\r\n    ...moduleOrdemDeCompra.mapActions({\r\n      getById: \"getById\",\r\n      update: \"update\",\r\n      createPurchaseMaterial: \"createPurchaseMaterial\",\r\n      setIfIsUpdated: \"setIfIsUpdated\",\r\n      getHasDeletedMaterials: \"getHasDeletedMaterials\",\r\n    }),\r\n    ...moduleClientes.mapActions({\r\n      getCustomerById: \"getById\",\r\n      getCustomerByValue: \"getByValue\",\r\n    }),\r\n\r\n    checkPermissionAndAddMaterial() {\r\n      if (this.hasPermission(this.$PermissionNames.permissionMaterialSee))\r\n        this.$refs.modalAddMaterial.open();\r\n      else\r\n        this.$refs.missingPermissionModal.open();\r\n    },\r\n\r\n    checkPermissionAndAddPayment() {\r\n      if (this.hasPermission(this.$PermissionNames.permissionCategorySituationSee))\r\n        this.modalAddPayments = true;\r\n      else\r\n        this.$refs.missingPermissionModal.open();\r\n    },\r\n\r\n    verifyAndSave() {\r\n      if (!this.hasPermission(this.$PermissionNames.permissionProformaSee) &&\r\n        !this.purchaseOrder.proformaId)\r\n        this.$refs.missingPermissionModal.open();\r\n      else if (\r\n        this.isDistribution ||\r\n        !this.originalProformaId ||\r\n        this.originalProformaId == this.purchaseOrder.proformaId\r\n      )\r\n        this.savePurchaseOrder();\r\n      else this.$refs.changeProformaDialog.open();\r\n    },\r\n\r\n    async reloadAddButton() {\r\n      this.purchaseOrder.hasDeletedMaterials =\r\n        await this.getHasDeletedMaterials(this.purchaseOrder.id);\r\n      this.tableLoading = true;\r\n    },\r\n\r\n    addZeroes(num, len) {\r\n      var numberWithZeroes = String(num);\r\n      var counter = numberWithZeroes.length;\r\n\r\n      while (counter < len) {\r\n        numberWithZeroes = \"0\" + numberWithZeroes;\r\n\r\n        counter++;\r\n      }\r\n\r\n      if (this.purchaseOrder.purchaseOrderType == 1)\r\n        return numberWithZeroes + \"-D\";\r\n      else return numberWithZeroes + \"-C\";\r\n    },\r\n\r\n    listPagamentos() {\r\n      this.listPayments = true;\r\n    },\r\n\r\n    async loadProformas(val) {\r\n      return await this.getAllProformaSearch({ searchText: val });\r\n    },\r\n    async getProforma(id) {\r\n      let response = await this.getProformaByCode(id);\r\n\r\n      if (response && response.data && !response.data.error) {\r\n        return {\r\n          value: response.data.result.code,\r\n          text:\r\n            response.data.result.code +\r\n            \" | \" +\r\n            response.data.result.proformaValue +\r\n            \" | \" +\r\n            response.data.result.customerName,\r\n        };\r\n      }\r\n      return null;\r\n    },\r\n    async getCustomer(id) {\r\n      let response = await this.getCustomerById(id);\r\n\r\n      if (response && response.data && !response.data.error) {\r\n        return {\r\n          value: response.data.result.id,\r\n          text: response.data.result.plant\r\n            ? response.data.result.code +\r\n              \" | \" +\r\n              response.data.result.corporateName +\r\n              \" | \" +\r\n              response.data.result.plant\r\n            : response.data.result.code +\r\n              \" | \" +\r\n              response.data.result.corporateName,\r\n        };\r\n      }\r\n      return null;\r\n    },\r\n    async loadCustomer(request) {\r\n      var response = await this.getCustomerByValue(request);\r\n      response.data.result.forEach((e) => {\r\n        this.customerData.push({\r\n          text:\r\n            e.code +\r\n            \" | \" +\r\n            e.corporateName +\r\n            \" | \" +\r\n            (e.plant == null ? \"-\" : e.plant),\r\n          value: e.id,\r\n        });\r\n      });\r\n      return this.customerData;\r\n    },\r\n\r\n    validateLength(files) {\r\n      if (!files) return;\r\n      var length = null;\r\n      for (let i = 0; i < files.length; i++) {\r\n        const element = files[i];\r\n        length = length + element.size;\r\n      }\r\n\r\n      if (length > 25000000) {\r\n        this.getEntityById();\r\n        this.alertError = true;\r\n        this.alertErrorText = \"O tamanho dos arquivos deve ser inferior à 25MB\";\r\n        setTimeout(() => {\r\n          this.alertError = false;\r\n        }, 5000);\r\n      }\r\n    },\r\n\r\n    getAllItemsToList() {\r\n      this.getEntityById();\r\n    },\r\n\r\n    async savePurchaseOrder() {\r\n      if (!this.$refs.formPurchase.validate()) return;\r\n      var items = {\r\n        id: this.$route.params.id,\r\n        isUpdated: true,\r\n      };\r\n      await this.setIfIsUpdated(items);\r\n      this.loadingBtnSave = true;\r\n      var files = [];\r\n      for (let i = 0; i < this.purchaseOrder.files.length; i++) {\r\n        const element = this.purchaseOrder.files[i];\r\n        var toBase = await toBase64(element, false);\r\n        files.push({ File: toBase, FileName: element.name });\r\n      }\r\n      this.purchaseOrder.files = files;\r\n\r\n      var response = await this.update(this.purchaseOrder);\r\n      if (response.status == 200) {\r\n        this.setSuccessMessage(\"Registro alterado com sucesso!\", 1);\r\n        this.loadingBtnSave = false;\r\n      } else this.loadingBtnSave = true;\r\n    },\r\n\r\n    async getEntityById() {\r\n      this.loadingComponent = true;\r\n      this.loading = true;\r\n      var response = await this.getById(this.$route.params.id);\r\n      if (response.status == 200) {\r\n        this.purchaseOrder = response.data.result;\r\n        this.originalProformaId = this.purchaseOrder.proformaId;\r\n        if (this.purchaseOrder.boardings.length == 0) {\r\n          var items = {\r\n            id: this.$route.params.id,\r\n            isUpdated: this.purchaseOrder.boardings.length == 0 ? true : false,\r\n          };\r\n          await this.setIfIsUpdated(items);\r\n\r\n          this.filesToDownload = this.purchaseOrder.files;\r\n        }\r\n        if (this.purchaseOrder.freightType == 1) {\r\n          this.setDelivery = true;\r\n        }\r\n\r\n        this.setFile();\r\n\r\n        this.loadingComponent = false;\r\n        this.loading = false;\r\n      }\r\n    },\r\n\r\n    verifyOrderType(value) {\r\n      if (value) {\r\n        var item = this.enumPurchaseOrder.filter((x) => x.value == value)[0];\r\n        return item.text;\r\n      }\r\n    },\r\n\r\n    async getSituations() {\r\n      var items = await this.getByType(\r\n        tiposCategorias.enumTiposCategoriasRequest.situaçãodaordemdecompra\r\n      );\r\n\r\n      items.forEach((element) => {\r\n        this.categorySituationItems.push({\r\n          value: element.id,\r\n          text: element.description,\r\n        });\r\n      });\r\n    },\r\n\r\n    verifyFreightType(value) {\r\n      if (!value) return;\r\n      var item = this.enumIncoterm.filter((x) => x.value == value)[0];\r\n      return item.text;\r\n    },\r\n\r\n    setErrorMessage(error) {\r\n      this.errorAlertColeta = true;\r\n      this.errorTextColeta = error;\r\n      setTimeout(() => {\r\n        this.errorAlertColeta = false;\r\n      }, 5000);\r\n    },\r\n\r\n    messageDeleteColeta() {\r\n      this.setSuccessMessage(\"Coleta deletada com sucesso!\", 5);\r\n    },\r\n\r\n    setSuccessMessage(v, i) {\r\n      if (i == 1) {\r\n        this.alertSuccessPurchase = true;\r\n        this.alertSuccessPurchaseText = v;\r\n      } else if (i == 2) {\r\n        this.alertSuccessMaterial = true;\r\n        this.alertSuccessMaterialText = v;\r\n      } else if (i == 3) {\r\n        this.alertSuccessPayments = true;\r\n        this.alertSuccessPaymentsText = v;\r\n      } else if (i == 4) {\r\n        this.alertSuccessBoardingMaterial = true;\r\n        this.alertSuccessBoardingMaterialText = v;\r\n      } else if (i == 5) {\r\n        this.alertSuccess = true;\r\n        this.alertSuccessText = v;\r\n      } else {\r\n        this.alertSuccess = true;\r\n        this.alertSuccessText = v;\r\n      }\r\n      setTimeout(() => {\r\n        this.alertSuccess = false;\r\n        this.alertSuccessPurchase = false;\r\n        this.alertSuccessMaterial = false;\r\n        this.alertSuccessPayments = false;\r\n        this.alertSuccessBoardingMaterial = false;\r\n      }, 5000);\r\n      this.listMaterials = true;\r\n      this.listDeliveries = true;\r\n      this.listCollections = true;\r\n      this.listPayments = true;\r\n      this.getEntityById();\r\n    },\r\n\r\n    async download() {\r\n      this.downloadFiles();\r\n    },\r\n\r\n    downloadFiles() {\r\n      if (this.filesToDownload) {\r\n        for (let i = 0; i < this.filesToDownload.length; i++) {\r\n          const element = this.filesToDownload[i];\r\n          var a = document.createElement(\"a\");\r\n          a.href = \"data:image/jpg;base64,\" + element.file;\r\n          a.download = element.fileName;\r\n          a.click();\r\n          a.remove();\r\n        }\r\n      }\r\n    },\r\n\r\n    setFile() {\r\n      if (this.purchaseOrder.files) {\r\n        var teste = [];\r\n        for (let i = 0; i < this.purchaseOrder.files.length; i++) {\r\n          teste.push(\r\n            new File(\r\n              [this.purchaseOrder.files[i].file],\r\n              this.purchaseOrder.files[i].fileName,\r\n              {\r\n                type: \"base64\",\r\n              }\r\n            )\r\n          );\r\n        }\r\n\r\n        this.purchaseOrder.files = teste;\r\n        // this.purchaseOrder.firstFile.push(item1, item2);\r\n      }\r\n    },\r\n\r\n    setListsToTrue() {\r\n      this.listMaterials = true;\r\n      this.listDeliveries = true;\r\n      this.listCollections = true;\r\n      this.listPayments = true;\r\n    },\r\n\r\n    setListsToFalse() {\r\n      this.listMaterials = false;\r\n      this.listDeliveries = false;\r\n      this.listCollections = false;\r\n      this.listPayments = false;\r\n    },\r\n  },\r\n\r\n  computed: {\r\n    isDistribution() {\r\n      return this.purchaseOrder.purchaseOrderType === 1;\r\n    },\r\n\r\n    editPermission() {\r\n      return this.hasPermission(\r\n        this.$PermissionNames.permissionPurchaseOrderEdit\r\n      );\r\n    },\r\n\r\n    currency() {\r\n      if (this.purchaseOrder.currency == 1) return \"USD\";\r\n      else return \"R$\";\r\n    },\r\n\r\n    itemsSituacaoCompra() {\r\n      return this.$store.state.ModuleOrdemDeCompra.situacaoPedido;\r\n    },\r\n  },\r\n\r\n  components: {\r\n    TopSection,\r\n    AutoCompleteFilterAsync,\r\n    Financeiro,\r\n    DatePicker,\r\n    Materiais,\r\n    Entregas,\r\n    Coletas,\r\n    ModalAddAndUpdateMaterials,\r\n    ModalAddAndUpdatePayments,\r\n    EmbarqueProforma,\r\n    Loading,\r\n    ModalChangeProforma,\r\n    MissingPermissionModal,\r\n  },\r\n\r\n  created() {\r\n    this.tipoFrete == \"CIF\" ? (this.entregas = true) : (this.coletas = true);\r\n  },\r\n\r\n  mounted() {\r\n    this.getEntityById();\r\n\r\n    if (this.hasPermission(this.$PermissionNames.permissionCategorySituationSee))\r\n      this.getSituations();\r\n\r\n    this.enumIncoterm = Object.values(enumIncotermPart);\r\n    this.enumPurchaseOrder = Object.values(enumPurchaseOrderType);\r\n  },\r\n\r\n  mixins: [validationRules],\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.titulo {\r\n  font-weight: 800;\r\n}\r\n</style>\r\n"]}]}