{"remainingRequest":"C:\\Users\\lemos\\OneDrive\\Documentos\\My Web Sites\\7.3.0\\vue\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\lemos\\OneDrive\\Documentos\\My Web Sites\\7.3.0\\vue\\src\\views\\tabelaPreco\\ViewMaterials.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\lemos\\OneDrive\\Documentos\\My Web Sites\\7.3.0\\vue\\src\\views\\tabelaPreco\\ViewMaterials.vue","mtime":1680609356667},{"path":"C:\\Users\\lemos\\OneDrive\\Documentos\\My Web Sites\\7.3.0\\vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1683229777571},{"path":"C:\\Users\\lemos\\OneDrive\\Documentos\\My Web Sites\\7.3.0\\vue\\node_modules\\vue-loader\\lib\\index.js","mtime":1683229780390}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQppbXBvcnQgTW9uZXkgZnJvbSAiQC9jb21wb25lbnRzL01vbmV5IjsNCmltcG9ydCB7IGNyZWF0ZU5hbWVzcGFjZWRIZWxwZXJzIH0gZnJvbSAidnVleCI7DQppbXBvcnQgQXV0b0NvbXBsZXRlRmlsdGVyQXN5bmMgZnJvbSAiQC9jb21wb25lbnRzL0F1dG9Db21wbGV0ZUZpbHRlckFzeW5jIjsNCmltcG9ydCB2YWxpZGF0aW9uUnVsZXMgZnJvbSAiLi4vLi4vbWl4aW5zL3ZhbGlkYXRpb25SdWxlcyI7DQppbXBvcnQgTWlzc2luZ1Blcm1pc3Npb25Nb2RhbCBmcm9tICJAL2NvbXBvbmVudHMvTWlzc2luZ1Blcm1pc3Npb25Nb2RhbC52dWUiOw0KDQpjb25zdCBtb2R1bGVNYXRlcmlhbHMgPSBjcmVhdGVOYW1lc3BhY2VkSGVscGVycygiTW9kdWxlTWF0ZXJpYWlzIik7DQoNCmV4cG9ydCBkZWZhdWx0IHsNCiAgcHJvcHM6IFsidmFsdWUiLCAicmVhZG9ubHkiXSwNCiAgY29tcG9uZW50czogew0KICAgIEF1dG9Db21wbGV0ZUZpbHRlckFzeW5jLA0KICAgIE1vbmV5LA0KICAgIE1pc3NpbmdQZXJtaXNzaW9uTW9kYWwsDQogIH0sDQoNCiAgZGF0YTogKCkgPT4gKHsNCiAgICBkYXRhTmV3SXRlbTogew0KICAgICAgbWF0ZXJpYWxJZDogbnVsbCwNCiAgICAgIHZhbG9yOiBudWxsLA0KICAgICAgcHJpY2VUYWJsZUlkOiBudWxsLA0KICAgIH0sDQogICAgZWRpdE1vZGU6IG51bGwsDQogICAgdmFsdWVUb0VkaXQ6IG51bGwsDQogICAgbGlzdE1hdGVyaWFsczogW10sDQogICAgaXRlbXNNYXRlcmlhbDogW10sDQogIH0pLA0KDQogIG1ldGhvZHM6IHsNCiAgICAuLi5tb2R1bGVNYXRlcmlhbHMubWFwQWN0aW9ucyh7DQogICAgICBnZXRBbGxNYXRlcmlhbHM6ICJnZXRBbGxNYXRlcmlhbHMiLA0KICAgICAgZ2V0QWxsU2VhcmNoOiAiZ2V0QWxsU2VhcmNoIiwNCiAgICAgIGdldEJ5SWQ6ICJnZXRCeUlkIiwNCiAgICB9KSwNCg0KICAgIGFkaWNpb25hck1hdGVyaWFsKCkgew0KICAgICAgaWYgKCF0aGlzLmhhc1Blcm1pc3Npb24odGhpcy4kUGVybWlzc2lvbk5hbWVzLnBlcm1pc3Npb25NYXRlcmlhbFNlZSkpIHsNCiAgICAgICAgdGhpcy4kcmVmcy5taXNzaW5nUGVybWlzc2lvbk1vZGFsLm9wZW4oKTsNCiAgICAgICAgcmV0dXJuOw0KICAgICAgfQ0KDQogICAgICB0aGlzLnZhbHVlVG9FZGl0ID0gdHJ1ZTsNCiAgICAgIHZhciBsaXN0ID0gdGhpcy5saXN0TWF0ZXJpYWxzOw0KICAgICAgdGhpcy5saXN0TWF0ZXJpYWxzID0gW107DQogICAgICB0aGlzLmxpc3RNYXRlcmlhbHMucHVzaCh7IC4uLnRoaXMuZGF0YU5ld0l0ZW0gfSk7DQogICAgICBsaXN0LmZvckVhY2goKGVsZW1lbnQpID0+IHsNCiAgICAgICAgdGhpcy5saXN0TWF0ZXJpYWxzLnB1c2goZWxlbWVudCk7DQogICAgICB9KTsNCiAgICB9LA0KDQogICAgYXN5bmMgZ2V0TWF0ZXJpYWwoaWQpIHsNCiAgICAgIGxldCByZXNwb25zZSA9IGF3YWl0IHRoaXMuZ2V0QnlJZChpZCk7DQogICAgICB0aGlzLnZhbHVlVG9FZGl0ID0gZmFsc2U7DQoNCiAgICAgIGlmIChyZXNwb25zZSAmJiByZXNwb25zZS5kYXRhICYmICFyZXNwb25zZS5kYXRhLmVycm9yKSB7DQogICAgICAgIHJldHVybiB7DQogICAgICAgICAgdmFsdWU6IHJlc3BvbnNlLmRhdGEucmVzdWx0LmlkLA0KICAgICAgICAgIHRleHQ6DQogICAgICAgICAgICByZXNwb25zZS5kYXRhLnJlc3VsdC5jb2RlICsNCiAgICAgICAgICAgICIgfCAiICsNCiAgICAgICAgICAgIHJlc3BvbnNlLmRhdGEucmVzdWx0LmRlc2NyaXB0aW9uLA0KICAgICAgICB9Ow0KICAgICAgfQ0KDQogICAgICByZXR1cm4gbnVsbDsNCiAgICB9LA0KDQogICAgYXN5bmMgbG9hZE1hdGVyaWFscyh2YWwpIHsNCiAgICAgIGxldCByZXN1bHQgPSBhd2FpdCB0aGlzLmdldEFsbFNlYXJjaCh7IHNlYXJjaFRleHQ6IHZhbCB9KTsNCg0KICAgICAgaWYgKHRoaXMubGlzdE1hdGVyaWFscy5sZW5ndGggPiAwKSB7DQogICAgICAgIHRoaXMubGlzdE1hdGVyaWFscy5mb3JFYWNoKChtYXRlcmlhbCkgPT4gew0KICAgICAgICAgIHJlc3VsdCA9IHJlc3VsdC5maWx0ZXIoKHgpID0+IHgudmFsdWUgIT0gbWF0ZXJpYWwubWF0ZXJpYWxJZCk7DQogICAgICAgIH0pOw0KICAgICAgfQ0KICAgICAgcmV0dXJuIHJlc3VsdDsNCiAgICB9LA0KDQogICAgcmVtb3ZlTWF0ZXJpYWwoaXRlbSkgew0KICAgICAgdGhpcy5saXN0TWF0ZXJpYWxzID0gdGhpcy5saXN0TWF0ZXJpYWxzLmZpbHRlcigoeCkgPT4geCAhPSBpdGVtKTsNCiAgICAgIHRoaXMudmFsdWVUb0VkaXQgPSB0cnVlOw0KICAgIH0sDQogIH0sDQoNCiAgY29tcHV0ZWQ6IHsNCiAgICBsaXN0TWF0ZXJpYWxMZW5ndGgoKSB7DQogICAgICBpZiAodGhpcy5saXN0TWF0ZXJpYWxzKSByZXR1cm4gdGhpcy5saXN0TWF0ZXJpYWxzLmxlbmd0aDsNCiAgICAgIGVsc2UgcmV0dXJuIDA7DQogICAgfSwNCiAgfSwNCiAgd2F0Y2g6IHsNCiAgICBsaXN0TWF0ZXJpYWxzOiB7DQogICAgICBpbW1lZGlhdGU6IHRydWUsDQogICAgICBkZWVwOiB0cnVlLA0KICAgICAgaGFuZGxlcihuZXdWYWx1ZSkgew0KICAgICAgICB0aGlzLiRlbWl0KCJpbnB1dCIsIG5ld1ZhbHVlKTsNCiAgICAgIH0sDQogICAgfSwNCiAgICB2YWx1ZSgpIHsNCiAgICAgIHRoaXMubGlzdE1hdGVyaWFscyA9IHRoaXMudmFsdWU7DQogICAgfSwNCiAgfSwNCg0KICBtaXhpbnM6IFt2YWxpZGF0aW9uUnVsZXNdLA0KfTsNCg=="},{"version":3,"sources":["ViewMaterials.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA+FA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA","file":"ViewMaterials.vue","sourceRoot":"src/views/tabelaPreco","sourcesContent":["<template>\r\n  <div class=\"pa-4 rounded-lg white elevation-5\" style=\"height: 100%\">\r\n    <div class=\"d-flex justify-space-between\">\r\n      <p style=\"color: #4d4d4d; font-weight: 700\">Materiais</p>\r\n      <v-btn\r\n        v-if=\"!readonly\"\r\n        rounded\r\n        small\r\n        color=\"#FEE066\"\r\n        class=\"asia-neutral--text elevation-0\"\r\n        style=\"letter-spacing: 0px\"\r\n        @click=\"adicionarMaterial()\"\r\n      >\r\n        + Adicionar\r\n      </v-btn>\r\n    </div>\r\n\r\n    <MissingPermissionModal \r\n      ref=\"missingPermissionModal\"\r\n    />\r\n\r\n    <v-divider></v-divider>\r\n    <div class=\"d-flex flex-column justify-space-between\" style=\"height: 90%\">\r\n      <div\r\n        class=\"d-flex align-center\"\r\n        v-for=\"(item, i) in listMaterials\"\r\n        :key=\"i\"\r\n      >\r\n        <v-btn v-if=\"!readonly\" @click=\"removeMaterial(item)\" class=\"mr-4\" icon>\r\n          <v-icon> mdi-delete </v-icon>\r\n        </v-btn>\r\n\r\n        <AutoCompleteFilterAsync\r\n          v-if=\"hasPermission($PermissionNames.permissionMaterialSee)\"\r\n          :disabled=\"readonly\"\r\n          :searchStore=\"loadMaterials\"\r\n          :validate_on_blur=\"true\"\r\n          :listItemsToEdit=\"valueToEdit\"\r\n          :getStore=\"getMaterial\"\r\n          displayText=\"nome\"\r\n          v-model=\"listMaterials[i].materialId\"\r\n          hint=\"Busque pelo Código ou Descrição\"\r\n          placeholder=\"Digite 3 caracteres\"\r\n          :rules=\"[rules.required]\"\r\n          class=\"mr-2\"\r\n          style=\"width: 70%\"\r\n        />\r\n        <v-text-field\r\n          v-else\r\n          v-model=\"listMaterials[i].materialDescription\"\r\n          disabled\r\n          label=\"Material\"\r\n          class=\"mr-2\"\r\n          style=\"width: 70%\"\r\n        >\r\n        </v-text-field>\r\n\r\n        <Money\r\n          :disabled=\"readonly\"\r\n          class=\"mr-3\"\r\n          v-model=\"listMaterials[i].valor\"\r\n          label=\"Valor/ton\"\r\n          :required=\"true\"\r\n          :notZeroOtherMessage=\"true\"\r\n          :validate_on_blur=\"true\"\r\n          :properties=\"{\r\n            prefix: 'USD',\r\n          }\"\r\n          :options=\"{\r\n            locale: 'pt-BR',\r\n            length: 12,\r\n            precision: 2,\r\n            empty: '0,00',\r\n          }\"\r\n        ></Money>\r\n\r\n        <!-- <v-text-field\r\n          label=\"Valor\"\r\n          :rules=\"[rules.required]\"\r\n          validate-on-blur\r\n          v-model=\"listMaterials[i].valor\"\r\n          clearable\r\n          style=\"width: 30%\"\r\n        >\r\n        </v-text-field> -->\r\n      </div>\r\n\r\n      <div class=\"d-flex justify-end mb-4\">\r\n        <span>{{ listMaterialLength }} itens na tabela</span>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport Money from \"@/components/Money\";\r\nimport { createNamespacedHelpers } from \"vuex\";\r\nimport AutoCompleteFilterAsync from \"@/components/AutoCompleteFilterAsync\";\r\nimport validationRules from \"../../mixins/validationRules\";\r\nimport MissingPermissionModal from \"@/components/MissingPermissionModal.vue\";\r\n\r\nconst moduleMaterials = createNamespacedHelpers(\"ModuleMateriais\");\r\n\r\nexport default {\r\n  props: [\"value\", \"readonly\"],\r\n  components: {\r\n    AutoCompleteFilterAsync,\r\n    Money,\r\n    MissingPermissionModal,\r\n  },\r\n\r\n  data: () => ({\r\n    dataNewItem: {\r\n      materialId: null,\r\n      valor: null,\r\n      priceTableId: null,\r\n    },\r\n    editMode: null,\r\n    valueToEdit: null,\r\n    listMaterials: [],\r\n    itemsMaterial: [],\r\n  }),\r\n\r\n  methods: {\r\n    ...moduleMaterials.mapActions({\r\n      getAllMaterials: \"getAllMaterials\",\r\n      getAllSearch: \"getAllSearch\",\r\n      getById: \"getById\",\r\n    }),\r\n\r\n    adicionarMaterial() {\r\n      if (!this.hasPermission(this.$PermissionNames.permissionMaterialSee)) {\r\n        this.$refs.missingPermissionModal.open();\r\n        return;\r\n      }\r\n\r\n      this.valueToEdit = true;\r\n      var list = this.listMaterials;\r\n      this.listMaterials = [];\r\n      this.listMaterials.push({ ...this.dataNewItem });\r\n      list.forEach((element) => {\r\n        this.listMaterials.push(element);\r\n      });\r\n    },\r\n\r\n    async getMaterial(id) {\r\n      let response = await this.getById(id);\r\n      this.valueToEdit = false;\r\n\r\n      if (response && response.data && !response.data.error) {\r\n        return {\r\n          value: response.data.result.id,\r\n          text:\r\n            response.data.result.code +\r\n            \" | \" +\r\n            response.data.result.description,\r\n        };\r\n      }\r\n\r\n      return null;\r\n    },\r\n\r\n    async loadMaterials(val) {\r\n      let result = await this.getAllSearch({ searchText: val });\r\n\r\n      if (this.listMaterials.length > 0) {\r\n        this.listMaterials.forEach((material) => {\r\n          result = result.filter((x) => x.value != material.materialId);\r\n        });\r\n      }\r\n      return result;\r\n    },\r\n\r\n    removeMaterial(item) {\r\n      this.listMaterials = this.listMaterials.filter((x) => x != item);\r\n      this.valueToEdit = true;\r\n    },\r\n  },\r\n\r\n  computed: {\r\n    listMaterialLength() {\r\n      if (this.listMaterials) return this.listMaterials.length;\r\n      else return 0;\r\n    },\r\n  },\r\n  watch: {\r\n    listMaterials: {\r\n      immediate: true,\r\n      deep: true,\r\n      handler(newValue) {\r\n        this.$emit(\"input\", newValue);\r\n      },\r\n    },\r\n    value() {\r\n      this.listMaterials = this.value;\r\n    },\r\n  },\r\n\r\n  mixins: [validationRules],\r\n};\r\n</script>\r\n"]}]}