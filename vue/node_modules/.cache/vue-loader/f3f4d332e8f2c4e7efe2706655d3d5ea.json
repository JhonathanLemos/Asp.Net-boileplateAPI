{"remainingRequest":"C:\\Users\\lemos\\OneDrive\\Documentos\\My Web Sites\\7.3.0\\vue\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\lemos\\OneDrive\\Documentos\\My Web Sites\\7.3.0\\vue\\src\\views\\ordemCompra\\materiais.vue?vue&type=style&index=0&id=88c1a686&scoped=true&lang=css&","dependencies":[{"path":"C:\\Users\\lemos\\OneDrive\\Documentos\\My Web Sites\\7.3.0\\vue\\src\\views\\ordemCompra\\materiais.vue","mtime":1680609356659},{"path":"C:\\Users\\lemos\\OneDrive\\Documentos\\My Web Sites\\7.3.0\\vue\\node_modules\\css-loader\\dist\\cjs.js","mtime":1683229778387},{"path":"C:\\Users\\lemos\\OneDrive\\Documentos\\My Web Sites\\7.3.0\\vue\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1683229781560},{"path":"C:\\Users\\lemos\\OneDrive\\Documentos\\My Web Sites\\7.3.0\\vue\\node_modules\\postcss-loader\\src\\index.js","mtime":1683229779724},{"path":"C:\\Users\\lemos\\OneDrive\\Documentos\\My Web Sites\\7.3.0\\vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1683229777571},{"path":"C:\\Users\\lemos\\OneDrive\\Documentos\\My Web Sites\\7.3.0\\vue\\node_modules\\vue-loader\\lib\\index.js","mtime":1683229780390}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKDQouYnV0dG9uVGV4dCB7DQogIGZvbnQtZmFtaWx5OiAiSW50ZXIiOw0KICBmb250LXN0eWxlOiBub3JtYWw7DQogIGZvbnQtd2VpZ2h0OiA4MDA7DQogIGZvbnQtc2l6ZTogMTVweDsNCiAgbGluZS1oZWlnaHQ6IDIxcHg7DQp9DQoNCi5idXR0b24gew0KICB3aWR0aDogMjg5cHg7DQogIGhlaWdodDogNDBweDsNCn0NCg=="},{"version":3,"sources":["materiais.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAwaA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA","file":"materiais.vue","sourceRoot":"src/views/ordemCompra","sourcesContent":["<template>\r\n  <div class=\"d-flex flex-column justify-space-between\">\r\n    <v-row\r\n      v-if=\"purchaseOrder.hasDeletedMaterials || isDistribution\"\r\n      class=\"mr-0 mt-0 mb-3\"\r\n      justify=\"end\"\r\n    >\r\n      <v-btn\r\n        v-if=\"editPermission\"\r\n        rounded\r\n        small\r\n        color=\"#FEE066\"\r\n        class=\"asia-neutral--text mr-2 button align-items-center\"\r\n        @click=\"$emit('addMaterial')\"\r\n      >\r\n        <v-icon small icon class=\"mr-2\">mdi-plus</v-icon>\r\n        <div class=\"buttonText\">ADICIONAR MATERIAL</div>\r\n      </v-btn>\r\n    </v-row>\r\n    <div class=\"flex-grow-1 rounded-lg pa-4 white elevation-5\">\r\n      <v-data-table\r\n        disable-sort\r\n        :headers=\"\r\n          isDistribution\r\n            ? editPermission\r\n              ? headersDistribution\r\n              : headersDistribution.filter((x) => x.value != 'col1')\r\n            : editPermission\r\n            ? headers\r\n            : headers.filter((x) => x.value != 'col1')\r\n        \"\r\n        :items=\"rows\"\r\n        noDataText=\"Nenhum registro encontrado\"\r\n        loading-text=\"Aguarde, carregando Materiais...\"\r\n        :loading=\"tableLoading\"\r\n        :footer-props=\"{\r\n          itemsPerPageOptions: [10, 50, 100],\r\n          itemsPerPageText: 'Itens por Página',\r\n        }\"\r\n        :expanded=\"['Valor total dos materiais sem IPI']\"\r\n      >\r\n        <!-- Icone Edição -->\r\n        <template v-slot:[`item.col1`]=\"{ item }\">\r\n          <div v-if=\"editPermission\" class=\"d-flex flex-nowrap\">\r\n            <v-btn icon @click=\"setEdition(item.col1)\">\r\n              <v-icon>mdi-pencil</v-icon>\r\n            </v-btn>\r\n\r\n            <v-btn\r\n              icon\r\n              @click=\"verifyMaterial(item.col1, item.col9, item.col4)\"\r\n            >\r\n              <v-icon> mdi-delete </v-icon>\r\n            </v-btn>\r\n          </div>\r\n        </template>\r\n\r\n        <template v-slot:[`item.col4`]=\"{ item }\">\r\n          <div v-if=\"item.col4\">\r\n            {{ `${item.col4} kg` }}\r\n          </div>\r\n        </template>\r\n\r\n        <template v-slot:[`item.col5`]=\"{ item }\">\r\n          <div v-if=\"item.col5\">\r\n            {{ `${item.col5} kg` }}\r\n          </div>\r\n        </template>\r\n\r\n        <template v-slot:[`item.col7`]=\"{ item }\">\r\n          <div v-if=\"item.col7 && currency == 'R$'\">\r\n            {{ item.col7 | currencyFormatReal }}\r\n          </div>\r\n\r\n          <div v-else-if=\"item.col7 && currency == 'USD'\">\r\n            {{ item.col7 | currencyFormat }}\r\n          </div>\r\n        </template>\r\n\r\n        <template v-slot:[`item.col8`]=\"{ item }\">\r\n          <div v-if=\"item.col8 && currency == 'R$'\">\r\n            {{ item.col8 | currencyFormatReal }}\r\n          </div>\r\n\r\n          <div v-else-if=\"item.col8 && currency == 'USD'\">\r\n            {{ item.col8 | currencyFormat }}\r\n          </div>\r\n        </template>\r\n\r\n        <template v-slot:[`body.append`]>\r\n          <div class=\"d-flex align-center pa-2\" style=\"width: 350%\">\r\n            <span class=\"flex-nowrap mr-2\" style=\"font-size: 12px\"\r\n              >Valor total dos materiais sem IPI</span\r\n            >\r\n            <span style=\"font-size: 14px\">\r\n              <b v-if=\"currency == 'R$'\">{{\r\n                valorTotalMaterial | currencyFormatReal\r\n              }}</b>\r\n\r\n              <b v-else-if=\"currency == 'USD'\">{{\r\n                valorTotalMaterial | currencyFormat\r\n              }}</b>\r\n            </span>\r\n          </div>\r\n\r\n          <div class=\"d-flex align-center ml-2 mb-2\" style=\"width: 350%\">\r\n            <span class=\"flex-nowrap mr-2\" style=\"font-size: 12px\"\r\n              >Valor total dos materiais com IPI (3,25%)</span\r\n            >\r\n            <span style=\"font-size: 14px\">\r\n              <b v-if=\"currency == 'R$'\">{{\r\n                valorTotalMaterialIPI | currencyFormatReal\r\n              }}</b>\r\n\r\n              <b v-else-if=\"currency == 'USD'\">{{\r\n                valorTotalMaterialIPI | currencyFormat\r\n              }}</b>\r\n            </span>\r\n          </div>\r\n        </template>\r\n      </v-data-table>\r\n    </div>\r\n\r\n    <!-- DIALOG CONFIRM DELETE -->\r\n    <v-dialog v-model=\"dialogDeleteConfirm\" max-width=\"360px\">\r\n      <div class=\"white pa-5 d-flex flex-column align-center text-center\">\r\n        <v-icon style=\"font-size: 60px\" color=\"#F75A02\"> mdi-alert </v-icon>\r\n\r\n        <h4\r\n          class=\"asia-neutral--text text--var-1 mb-8 mt-8\"\r\n          style=\"font-size: 15px\"\r\n        >\r\n          Deseja <b>remover</b> o <b>material?</b> <br />\r\n          Esta ação <b>não</b> pode ser <b>desfeita.</b>\r\n        </h4>\r\n\r\n        <div class=\"d-flex flex-row justify-end\">\r\n          <v-btn\r\n            rounded\r\n            large\r\n            text\r\n            class=\"mr-4\"\r\n            @click=\"dialogDeleteConfirm = false\"\r\n            >CANCELAR</v-btn\r\n          >\r\n\r\n          <v-btn\r\n            rounded\r\n            large\r\n            color=\"#F75A02\"\r\n            class=\"white--text\"\r\n            @click=\"deleteMaterialFromList\"\r\n            >REMOVER</v-btn\r\n          >\r\n        </div>\r\n      </div>\r\n    </v-dialog>\r\n\r\n    <!-- DIALOG NÃO PODE SER REMOVIDO -->\r\n    <v-dialog v-model=\"dialogAvisoDelete\" max-width=\"360px\">\r\n      <div class=\"white pa-5 d-flex flex-column align-center text-center\">\r\n        <v-icon style=\"font-size: 60px\" color=\"#E10000\">\r\n          mdi-alert-octagon\r\n        </v-icon>\r\n\r\n        <h4\r\n          class=\"asia-neutral--text text--var-1 mb-8 mt-8\"\r\n          style=\"font-size: 15px\"\r\n        >\r\n          Este material já possui entregas ou coletas <br />\r\n          realizadas. Por este motivo não pode ser <br />\r\n          removido.\r\n        </h4>\r\n\r\n        <div class=\"d-flex flex-row justify-end\">\r\n          <v-btn\r\n            style=\"background: #e10000\"\r\n            dark\r\n            rounded\r\n            large\r\n            text\r\n            class=\"mr-4\"\r\n            @click=\"dialogAvisoDelete = false\"\r\n            >FECHAR MENSAGEM</v-btn\r\n          >\r\n        </div>\r\n      </div>\r\n    </v-dialog>\r\n\r\n    <!-- Modal Edit Material-->\r\n    <modal-add-and-update-materials\r\n      ref=\"modalEditMaterial\"\r\n      :currency=\"currency\"\r\n      :isDistribution=\"isDistribution\"\r\n      @setListsToTrue=\"getAllMaterials\"\r\n      @setSuccessMessage=\"setSuccessMessage\"\r\n      @reloadButton=\"$emit('reloadButton')\"\r\n    ></modal-add-and-update-materials>\r\n\r\n    <v-dialog v-model=\"dialogErrorDeleteMaterial\" max-width=\"350px\">\r\n      <div class=\"white pa-8 d-flex flex-column align-center text-center\">\r\n        <v-icon style=\"font-size: 60px\" color=\"asia-red\">\r\n          mdi-alert-octagon\r\n        </v-icon>\r\n\r\n        <h4 class=\"asia-neutral--text text--var-1 pb-5 pt-5\">\r\n          {{ messageDialogError }}\r\n        </h4>\r\n\r\n        <v-btn\r\n          block\r\n          style=\"background: #c90c0f\"\r\n          rounded\r\n          large\r\n          text\r\n          color=\"white\"\r\n          @click=\"dialogErrorDeleteMaterial = false\"\r\n          >FECHAR</v-btn\r\n        >\r\n      </div>\r\n    </v-dialog>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport validationRules from \"../../mixins/validationRules\";\r\nimport ModalAddAndUpdateMaterials from \"./ModalAddAndUpdateMaterials.vue\";\r\nimport { createNamespacedHelpers } from \"vuex\";\r\n\r\nconst moduleMaterials = createNamespacedHelpers(\"ModuleOrdemDeCompraMaterials\");\r\nconst moduleDelivery = createNamespacedHelpers(\"ModuleDelivery\");\r\nconst moduleCollection = createNamespacedHelpers(\"ModuleColetas\");\r\nconst moduleColetasMateriais = createNamespacedHelpers(\r\n  \"ModuleColetasMaterials\"\r\n);\r\nconst moduleOrdemDeCompraMaterials = createNamespacedHelpers(\r\n  \"ModuleOrdemDeCompraMaterials\"\r\n);\r\n\r\nexport default {\r\n  props: [\r\n    \"getMaterials\",\r\n    \"isDelivery\",\r\n    \"isDistribution\",\r\n    \"purchaseOrder\",\r\n    \"currency\",\r\n  ],\r\n  data: () => ({\r\n    headersDistribution: [\r\n      { text: \"\", value: \"col1\", width: \"5%\" },\r\n      { text: \"Código\", value: \"col2\" },\r\n      { text: \"Descrição\", value: \"col3\" },\r\n      { text: \"Provisionada\", value: \"col4\" },\r\n      { text: \"Faturada\", value: \"col6\" },\r\n      { text: \"Valor Unitário (sem IPI)\", value: \"col7\" },\r\n      { text: \"Valor Total\", value: \"col8\" },\r\n    ],\r\n    headers: [\r\n      { text: \"\", value: \"col1\", width: \"5%\" },\r\n      { text: \"Código\", value: \"col2\" },\r\n      { text: \"Descrição\", value: \"col3\" },\r\n      { text: \"Provisionado O.C.\", value: \"col4\" },\r\n      { text: \"Embarcado\", value: \"col5\" },\r\n      { text: \"Faturado\", value: \"col6\" },\r\n      { text: \"Valor Unitário\", value: \"col7\" },\r\n      { text: \"Valor Total\", value: \"col8\" },\r\n    ],\r\n    rows: [],\r\n    id: null,\r\n    valorTotalMaterial: null,\r\n    valorTotalMaterialIPI: null,\r\n    dialogDeleteConfirm: false,\r\n    materialToDeleteId: null,\r\n    dialogAvisoDelete: false,\r\n    tableLoading: true,\r\n    dialogErrorDeleteMaterial: false,\r\n    listAllMaterial: [],\r\n    messageDialogError: null,\r\n  }),\r\n\r\n  methods: {\r\n    ...moduleMaterials.mapActions({\r\n      getAllByPurchase: \"getAllByPurchase\",\r\n      delete: \"delete\",\r\n    }),\r\n\r\n    ...moduleDelivery.mapActions({\r\n      getAllByPurchaseDelivery: \"getAllByPurchase\",\r\n    }),\r\n\r\n    ...moduleCollection.mapActions({\r\n      getAllByPurchaseCollection: \"getAllByPurchase\",\r\n    }),\r\n\r\n    ...moduleColetasMateriais.mapActions({\r\n      isMaterialDelivered: \"isMaterialDelivered\",\r\n      deleteByMaterial: \"deleteByMaterial\",\r\n      isMaterialPresentInConcludedCollect:\r\n        \"isMaterialPresentInConcludedCollect\",\r\n    }),\r\n\r\n    ...moduleOrdemDeCompraMaterials.mapActions({\r\n      getOrdemCompraMaterialById: \"getById\",\r\n    }),\r\n\r\n    async verifyMaterial(id, materialId, provisionedQtd) {\r\n      let params = {\r\n        idOrder: this.$route.params.id,\r\n        materialId: materialId,\r\n        provisionedQuantity: provisionedQtd,\r\n      };\r\n\r\n      let isDelivery = await this.isMaterialDelivered(params);\r\n\r\n      if (isDelivery.data.result) {\r\n        this.messageDialogError =\r\n          \"Não é possível excluir este material, pois já foi faturado.\";\r\n        this.dialogErrorDeleteMaterial = true;\r\n        return;\r\n      }\r\n\r\n      let isEmUmaColetaConcluida =\r\n        await this.isMaterialPresentInConcludedCollect(params);\r\n\r\n      if (isEmUmaColetaConcluida.data.result) {\r\n        this.messageDialogError =\r\n          \"Não é possível excluir este material, pois ele está presente em uma coleta já concluída.\";\r\n        this.dialogErrorDeleteMaterial = true;\r\n        return;\r\n      }\r\n\r\n      this.dialogDeleteConfirm = true;\r\n      this.materialToDeleteId = id;\r\n    },\r\n\r\n    async deleteMaterialFromList() {\r\n      var ordemCompraMaterial = await this.getOrdemCompraMaterialById(\r\n        this.materialToDeleteId\r\n      );\r\n      var response = await this.delete(this.materialToDeleteId);\r\n\r\n      if (response.status == 200) {\r\n        let params = {\r\n          idMaterial: ordemCompraMaterial.data.result.materialId,\r\n          provisionedQtd: ordemCompraMaterial.data.result.provisionedQtd,\r\n        };\r\n        await this.deleteByMaterial(params);\r\n\r\n        this.getAllMaterials();\r\n        this.dialogDeleteConfirm = false;\r\n        this.$emit(\"setSuccessOnRemoveMessage\");\r\n      }\r\n      this.$emit(\"reloadButton\");\r\n    },\r\n\r\n    buildRows(data) {\r\n      this.valorTotalMaterial = 0;\r\n      this.valorTotalMaterialIPI = 0;\r\n      data.forEach((element) => {\r\n        var teste = element.provisionedQtd * element.unitaryValue;\r\n        this.valorTotalMaterial = this.valorTotalMaterial + teste;\r\n      });\r\n      this.valorTotalMaterialIPI =\r\n        this.valorTotalMaterial + (this.valorTotalMaterial * 3.25) / 100;\r\n      this.rows = data.map((e) => ({\r\n        col1: e.id,\r\n        col2: e.materialCode,\r\n        col3: e.materialName,\r\n        col4: e.provisionedQtd,\r\n        col5: e.shippedQuantity,\r\n        col6: e.billedAmount ? e.billedAmount + \" kg\" : null,\r\n        col7: e.unitaryValue,\r\n        col8: e.provisionedQtd * e.unitaryValue,\r\n        col9: e.materialId,\r\n      }));\r\n    },\r\n\r\n    setEdition(id) {\r\n      this.$refs.modalEditMaterial.editMaterial(id);\r\n      this.id = id;\r\n    },\r\n\r\n    async getAllMaterials() {\r\n      let item = {\r\n        id: this.$route.params.id,\r\n        isDelivery: this.isDelivery ? true : false,\r\n      };\r\n      let response = await this.getAllByPurchase(item);\r\n      this.listAllMaterial = response.data.result;\r\n      this.buildRows(response.data.result);\r\n      this.tableLoading = false;\r\n      this.$emit(\"setListsToTrue\", true);\r\n      this.$emit(\"setListToFalse\", false);\r\n    },\r\n\r\n    setSuccessMessage() {\r\n      this.$emit(\"setSuccessMessage\", true);\r\n    },\r\n  },\r\n\r\n  mounted() {\r\n    this.getAllMaterials();\r\n  },\r\n\r\n  watch: {\r\n    getMaterials() {\r\n      this.getAllMaterials();\r\n    },\r\n  },\r\n\r\n  computed: {\r\n    editPermission() {\r\n      return this.hasPermission(\r\n        this.$PermissionNames.permissionPurchaseOrderEdit\r\n      );\r\n    },\r\n  },\r\n  components: { ModalAddAndUpdateMaterials },\r\n\r\n  mixins: [validationRules],\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.buttonText {\r\n  font-family: \"Inter\";\r\n  font-style: normal;\r\n  font-weight: 800;\r\n  font-size: 15px;\r\n  line-height: 21px;\r\n}\r\n\r\n.button {\r\n  width: 289px;\r\n  height: 40px;\r\n}\r\n</style>\r\n"]}]}