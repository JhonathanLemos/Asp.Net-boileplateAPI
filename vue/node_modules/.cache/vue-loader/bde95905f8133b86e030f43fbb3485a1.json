{"remainingRequest":"C:\\Users\\lemos\\OneDrive\\Documentos\\My Web Sites\\7.3.0\\vue\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\lemos\\OneDrive\\Documentos\\My Web Sites\\7.3.0\\vue\\src\\views\\usuarios\\ViewUsuariosCreate.vue?vue&type=style&index=0&id=6a2d9cb4&scoped=true&lang=css&","dependencies":[{"path":"C:\\Users\\lemos\\OneDrive\\Documentos\\My Web Sites\\7.3.0\\vue\\src\\views\\usuarios\\ViewUsuariosCreate.vue","mtime":1683748024062},{"path":"C:\\Users\\lemos\\OneDrive\\Documentos\\My Web Sites\\7.3.0\\vue\\node_modules\\css-loader\\dist\\cjs.js","mtime":1683229778387},{"path":"C:\\Users\\lemos\\OneDrive\\Documentos\\My Web Sites\\7.3.0\\vue\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1683229781560},{"path":"C:\\Users\\lemos\\OneDrive\\Documentos\\My Web Sites\\7.3.0\\vue\\node_modules\\postcss-loader\\src\\index.js","mtime":1683229779724},{"path":"C:\\Users\\lemos\\OneDrive\\Documentos\\My Web Sites\\7.3.0\\vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1683229777571},{"path":"C:\\Users\\lemos\\OneDrive\\Documentos\\My Web Sites\\7.3.0\\vue\\node_modules\\vue-loader\\lib\\index.js","mtime":1683229780390}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKLnJvdyB7CiAgZ2FwOiA0MCU7Cn0KCgouc2VsZWN0QWxsIHsKICBtYXJnaW4tbGVmdDogMzBweDsKICBjdXJzb3I6IHBvaW50ZXI7Cn0KCi52LXRhYiB7CiAgdGV4dC10cmFuc2Zvcm06IG5vbmUgIWltcG9ydGFudDsKfQo="},{"version":3,"sources":["ViewUsuariosCreate.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA8TA;AACA;AACA;;;AAGA;AACA;AACA;AACA;;AAEA;AACA;AACA","file":"ViewUsuariosCreate.vue","sourceRoot":"src/views/usuarios","sourcesContent":["<template>\n  <div\n    class=\"d-flex flex-column justify-space-between mx-10\"\n    style=\"width: 100%; height: 100%; overflow: auto\"\n  >\n    <!-- DIALOG CONFIRM SALVAR -->\n    <v-dialog v-model=\"dialogConfirmSalvar\" persistent max-width=\"450px\">\n      <div class=\"white pa-8 d-flex flex-column align-center text-center\">\n        <v-icon style=\"font-size: 60px; border-radius: 15px\" color=\"purple\"\n          >mdi-alert</v-icon\n        >\n\n        <div class=\"d-flex align-start\">\n          <h4 class=\"myApi-neutral--text text--var-1 pb-5 pt-5 mb-4\">\n            Após salvar não será possível alterar <br />\n            o endereço de e-mail do cadastro. <br />\n            Deseja continuar?\n          </h4>\n        </div>\n\n        <div class=\"d-flex flex-row justify-end\">\n          <v-btn\n            rounded\n            large\n            text\n            class=\"mr-8\"\n            @click=\"dialogConfirmSalvar = false\"\n            >CANCELAR</v-btn\n          >\n\n          <v-btn\n            rounded\n            large\n            class=\"white--text\"\n            style=\"background: purple\"\n            @click=\"submit\"\n            :loading=\"loadingBtnDelete\"\n            >SALVAR</v-btn\n          >\n        </div>\n      </div>\n    </v-dialog>\n    <!-- FIM -->\n\n    <!-- DIALOG CONFIRM MUDAR SENHA -->\n    <v-dialog v-model=\"dialogConfirMudarSenha\" persistent max-width=\"450px\">\n      <div class=\"white pa-8 d-flex flex-column align-center text-center\">\n        <v-icon style=\"font-size: 60px; border-radius: 15px\" color=\"purple\"\n          >mdi-alert</v-icon\n        >\n\n        <div class=\"d-flex align-start\">\n          <h4 class=\"myApi-neutral--text text--var-1 pb-5 pt-5 mb-4\">\n            A senha do usuário será substituída <br />\n            pela senha padrão do sistema. <br />\n            Deseja continuar?\n          </h4>\n        </div>\n\n        <div class=\"d-flex flex-row justify-end\">\n          <v-btn\n            rounded\n            large\n            text\n            class=\"mr-8\"\n            @click=\"dialogConfirMudarSenha = false\"\n            >CANCELAR</v-btn\n          >\n\n          <v-btn\n            rounded\n            large\n            class=\"white--text\"\n            style=\"background: purple\"\n            @click=\"substituirSenha\"\n            :loading=\"loadingBtnDelete\"\n            >SUBSTITUIR SENHA</v-btn\n          >\n        </div>\n      </div>\n    </v-dialog>\n    <!-- FIM -->\n\n    <top-section></top-section>\n\n    <div class=\"d-flex justify-space-between align-end mb-2\">\n      <h2 class=\"myApi-neutral--text text--var-1\">{{ $route.meta.title }}</h2>\n\n      <div v-if=\"editPermission\" class=\"d-flex flex-row justify-end align-end\">\n        <v-btn\n          dense\n          rounded\n          class=\"mr-3\"\n          text\n          @click=\"$router.push(`/home/usuarios`)\"\n        >\n          CANCELAR\n        </v-btn>\n\n        <v-btn\n          rounded\n          dense\n          class=\"myApi-purple white--text\"\n          @click=\"checkAndSave()\"\n          :loading=\"loadingBtnSave\"\n          >SALVAR</v-btn\n        >\n      </div>\n    </div>\n\n    <v-alert\n      style=\"width: 100%\"\n      type=\"success\"\n      transition=\"slide-y-transition\"\n      dismissible\n      v-show=\"alertSuccess\"\n      dense\n      >{{ alertSuccessText }}</v-alert\n    >\n\n    <v-alert\n      type=\"error\"\n      dense\n      class=\"mt-1\"\n      outlined\n      v-show=\"errorAlert\"\n      transition=\"fade-transition\"\n      >{{ errorAlertText }}</v-alert\n    >\n\n    <div class=\"white rounded-lg flex-grow-1\">\n      <div class=\"d-flex flex-column\" style=\"width: 100%\">\n        <v-tabs dark background-color=\"purple\" v-model=\"tabs\">\n          <v-tab href=\"#tab-1\">Informações Gerais</v-tab>\n          <v-tab href=\"#tab-2\">Permissões</v-tab>\n        </v-tabs>\n\n        <v-tabs-items touchless class=\"pa-4\" v-model=\"tabs\">\n          <v-tab-item value=\"tab-1\">\n            <informacoes-gerais\n              ref=\"informacoesGerais\"\n              :user=\"dataNewItem\"\n              :readonly=\"!editPermission\"\n              @mudarSenha=\"dialogConfirMudarSenha = true\"\n            />\n          </v-tab-item>\n\n            <v-tab-item value=\"tab-2\" :eager=\"true\">\n            <perfil-usuario\n              ref=\"permissions\"\n              v-model=\"dataNewItem.roleNames\"\n              :readonly=\"!editPermission\"\n              @mudarSenha=\"dialogConfirMudarSenha = true\"\n            />\n          </v-tab-item>\n        </v-tabs-items>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport TopSection from \"@/components/TopSection.vue\";\nimport getRouterData from \"@/mixins/getRouterData.js\";\nimport crudController from \"@/mixins/crudController.js\";\nimport { mapActions } from \"vuex\";\nimport informacoesGerais from \"@/views/usuarios/informacoesGerais/informacoesGerais.vue\";\nimport perfilUsuario from \"./permissoes/perfilUsuario.vue\";\n\nexport default {\n  data: () => ({\n    tabs: null,\n    dialogConfirmSalvar: false,\n    dialogConfirMudarSenha: false,\n    perfil: [],\n    alertSuccess: null,\n    alertSuccessText: null,\n    dataNewItem: {\n      id: 0,\n      userProfile: null,\n      roleProfile: null,\n      isCustomized: false,\n      isActive: null,\n    },\n    trip: {\n      name: \"\",\n      location: null,\n      start: null,\n      end: null,\n    },\n    loadingPermissions: false,\n    openExpansionPanel: null,\n    hideList: null,\n  }),\n\n  computed: {\n    editPermission() {\n      return this.hasPermission(this.$PermissionNames.permissionUserEdit);\n    },\n  },\n\n  mixins: [\n    getRouterData,\n    crudController({ store: \"ModuleUsuarios\" }),\n  ],\n\n  components: {\n    TopSection,\n    informacoesGerais,\n    perfilUsuario\n  },\n\n  watch: {\n    success() {\n      if (this.success) this.$router.push({ path: `/home/usuarios` });\n    },\n  },\n\n  methods: {\n    ...mapActions(\"ModuleUsuarios\", {\n      getUserById: \"getById\",\n      setDefaultPassword: \"setDefaultPassword\",\n      checkUserEmail: \"checkUserEmail\",\n    }),\n    async checkAndSave() {\n      if (!this.$route.params.id) {\n        if (!this.$refs.informacoesGerais.validateForm) return;\n        var response = await this.checkUserEmail(this.dataNewItem.emailAddress);\n        if (response.status != 200) {\n          this.errorAlert = true;\n          this.errorAlertText = response.error.message;\n          setTimeout(() => {\n            this.errorAlert = false;\n          }, 5000);\n          return;\n        }\n      }\n      if (!this.dataNewItem.id && this.validateForms())\n        this.dialogConfirmSalvar = true;\n      else this.submit();\n    },\n\n    validateForms() {\n      if (!this.$refs.informacoesGerais.validateForm) {\n        if (this.tabs != \"tab-1\")\n          this.showMessageValidateForm(\"Informações Gerais\");\n        return false;\n      } else if (!this.$refs.permissions.validateForm) {\n        if (this.tabs != \"tab-2\") this.showMessageValidateForm(\"Permissões\");\n        return false;\n      }\n\n      return true\n    },\n\n    showMessageValidateForm(abaNome) {\n      this.errorAlert = true;\n      this.errorAlertText = `A aba ${abaNome} contém campos não preenchidos.`;\n      setTimeout(() => {\n        this.errorAlert = false;\n      }, 5000);\n    },\n\n    async submit() {\n      debugger\n      if (this.validateForms()) {\n        var [name, surname] = this.dataNewItem.name.split(/(?<=^\\S+)\\s/);\n        this.dataNewItem.name = name;\n\n        if (!surname) this.dataNewItem.surname = name;\n        else this.dataNewItem.surname = name;\n\n        if(!Array.isArray(this.dataNewItem.roleNames))\n        {\n          this.dataNewItem.roleNames = [this.dataNewItem.roleNames]\n        }\n\n        if (this.$route.params.id) {\n          this.dataSelectedItem = this.dataNewItem;\n          this.updateItem();\n        } else {\n          this.addNewItem();\n        }\n      }\n    },\n\n    async getById() {\n      if (this.$route.params.id) {\n        var result = await this.getUserById(this.$route.params.id);\n        this.dataNewItem = result.data.result;\n        this.dataNewItem.name =\n          result.data.result.name + \" \" + result.data.result.surname;\n      }\n    },\n\n    async substituirSenha() {\n      var id = this.$route.params.id;\n      var response = await this.setDefaultPassword(id);\n      if (response.status == 200) {\n        this.dialogConfirMudarSenha = false;\n        this.alertSuccess = true;\n        this.alertSuccessText = \"Senha alterada com sucesso!\";\n\n        setTimeout(() => {\n          this.alertSuccess = false;\n        }, 5000);\n      }\n    },\n  },\n  async mounted() {\n    this.dataNewItem.isActive = true;\n    await this.getById();\n\n  },\n};\n</script>\n\n<style scoped>\n.row {\n  gap: 40%;\n}\n\n\n.selectAll {\n  margin-left: 30px;\n  cursor: pointer;\n}\n\n.v-tab {\n  text-transform: none !important;\n}\n</style>\n"]}]}