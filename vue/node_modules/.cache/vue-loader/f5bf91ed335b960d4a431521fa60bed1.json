{"remainingRequest":"C:\\Users\\lemos\\OneDrive\\Documentos\\My Web Sites\\7.3.0\\vue\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\lemos\\OneDrive\\Documentos\\My Web Sites\\7.3.0\\vue\\src\\views\\proformas\\financeiro\\ProformaFinancial.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\lemos\\OneDrive\\Documentos\\My Web Sites\\7.3.0\\vue\\src\\views\\proformas\\financeiro\\ProformaFinancial.vue","mtime":1680609356662},{"path":"C:\\Users\\lemos\\OneDrive\\Documentos\\My Web Sites\\7.3.0\\vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1683229777571},{"path":"C:\\Users\\lemos\\OneDrive\\Documentos\\My Web Sites\\7.3.0\\vue\\node_modules\\vue-loader\\lib\\index.js","mtime":1683229780390}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQppbXBvcnQgQ2F0ZWdvcnlDaGlwIGZyb20gJ0AvY29tcG9uZW50cy9DYXRlZ29yeUNoaXAudnVlJw0KaW1wb3J0IExvYWRpbmcgZnJvbSAnQC9jb21wb25lbnRzL0xvYWRpbmcudnVlJw0KaW1wb3J0IEZpbmFuY2lhbE1vZGFsVXBkYXRlQ3JlYXRlIGZyb20gJy4vRmluYW5jaWFsTW9kYWxVcGRhdGVDcmVhdGUudnVlJw0KaW1wb3J0IE1pc3NpbmdQZXJtaXNzaW9uTW9kYWwgZnJvbSAiQC9jb21wb25lbnRzL01pc3NpbmdQZXJtaXNzaW9uTW9kYWwudnVlIjsNCg0KZXhwb3J0IGRlZmF1bHQgew0KICBuYW1lOiAnUHJvZm9ybWFGaW5hbmNpYWwnLA0KICBwcm9wczogWyd2YWx1ZScsICdyZWFkb25seSddLA0KDQogIGRhdGE6ICgpID0+ICh7DQogICAgb3B0aW9uczoge30sDQogICAgaGVhZGVyc0ZpbmFuY2Vpcm86IFsNCiAgICAgIHsgdGV4dDogJycsIHZhbHVlOiAnaWRWaXJ0dWFsJyB9LA0KICAgICAgeyB0ZXh0OiAnQ2F0ZWdvcmlhJywgdmFsdWU6ICdwYXltZW50Q2F0ZWdvcnknIH0sDQogICAgICB7IHRleHQ6ICdEYXRhIFByZXZpc3RhJywgdmFsdWU6ICdleHBlY3RlZERhdGUnIH0sDQogICAgICB7IHRleHQ6ICdEYXRhIFJlYWxpemFkYScsIHZhbHVlOiAnZGF0ZScgfSwNCiAgICAgIHsgdGV4dDogJ1ZhbG9yJywgdmFsdWU6ICd2YWx1ZScgfSwNCiAgICAgIHsgdGV4dDogJ1NpdHVhw6fDo28nLCB2YWx1ZTogJ3BheW1lbnRTaXR1YXRpb24nIH0sDQogICAgXSwNCiAgICBwYXltZW50czogW10sDQogICAgc2hvd01vZGFsOiBmYWxzZSwNCiAgICB0b3RhbFZhbHVlOiAwLA0KICB9KSwNCiAgd2F0Y2g6IHsNCiAgICBvcHRpb25zOiB7DQogICAgICBoYW5kbGVyKCkgew0KICAgICAgICB0aGlzLnBheW1lbnRzID0gdGhpcy52YWx1ZS5tYXAoKGl0ZW0sIGluZGV4KSA9PiAoew0KICAgICAgICAgIC4uLml0ZW0sDQogICAgICAgICAgaWRWaXJ0dWFsOiBpbmRleCwNCiAgICAgICAgfSkpDQogICAgICB9LA0KICAgICAgZGVlcDogdHJ1ZSwNCiAgICB9LA0KICAgIHBheW1lbnRzOiB7DQogICAgICBkZWVwOiB0cnVlLA0KICAgICAgaGFuZGxlcigpIHsNCiAgICAgICAgdGhpcy4kZW1pdCgnaW5wdXQnLCB0aGlzLnBheW1lbnRzKQ0KICAgICAgfSwNCiAgICB9LA0KICB9LA0KICBtZXRob2RzOiB7DQogICAgYXN5bmMgY3JlYXRlSXRlbSgpIHsNCiAgICAgIGlmICh0aGlzLmhhc1Blcm1pc3Npb24odGhpcy4kUGVybWlzc2lvbk5hbWVzLnBlcm1pc3Npb25DYXRlZ29yeVNpdHVhdGlvblNlZSkpDQogICAgICAgIHRoaXMuJHJlZnMuZmluYW5jaWFsTW9kYWwuc2hvd0RpYWxvZyh7fSk7DQogICAgICBlbHNlDQogICAgICAgIHRoaXMuJHJlZnMubWlzc2luZ1Blcm1pc3Npb25Nb2RhbC5vcGVuKCk7DQogICAgfSwNCiAgICBkZWxldGVJdGVtKGN1cnJlbnRJZCkgew0KICAgICAgdGhpcy5wYXltZW50cyA9IHRoaXMucGF5bWVudHMuZmlsdGVyKCh4KSA9PiB4LmlkVmlydHVhbCAhPSBjdXJyZW50SWQpDQogICAgICB0aGlzLnJlZnJlc2hUb3RhbFZhbHVlKCk7DQogICAgfSwNCiAgICBhc3luYyB1cGRhdGVJdGVtKGN1cnJlbnRJZCkgew0KICAgICAgdGhpcy4kcmVmcy5maW5hbmNpYWxNb2RhbC5zaG93RGlhbG9nKHsNCiAgICAgICAgLi4udGhpcy5wYXltZW50cy5maW5kKCh4KSA9PiB4LmlkVmlydHVhbCA9PSBjdXJyZW50SWQpLA0KICAgICAgfSkNCiAgICB9LA0KICAgIGFzeW5jIHJlZnJlc2hUb3RhbFZhbHVlKCkgew0KICAgICAgdGhpcy50b3RhbFZhbHVlID0NCiAgICAgICAgdGhpcy5wYXltZW50cy5sZW5ndGggPiAwDQogICAgICAgICAgPyB0aGlzLnBheW1lbnRzLm1hcCgoeCkgPT4gTnVtYmVyKHgudmFsdWUpKS5yZWR1Y2UoKHgsIHkpID0+IHggKyB5KQ0KICAgICAgICAgIDogMA0KICAgIH0sDQogICAgc2F2ZUZpbmFuY2lhbEl0ZW0oaXRlbSkgew0KICAgICAgaWYgKGl0ZW0uaWRWaXJ0dWFsID09IC0xKSB7DQogICAgICAgIGxldCBsYXN0SXRlbSA9IHRoaXMucGF5bWVudHMuc2xpY2UoLTEpDQogICAgICAgIGl0ZW0ucGF5bWVudFNpdHVhdGlvbklkID0gaXRlbS5wYXltZW50U2l0dWF0aW9uLmlkDQogICAgICAgIGl0ZW0ucGF5bWVudENhdGVnb3J5SWQgPSBpdGVtLnBheW1lbnRDYXRlZ29yeS5pZA0KICAgICAgICB0aGlzLnBheW1lbnRzLnB1c2goew0KICAgICAgICAgIC4uLml0ZW0sDQogICAgICAgICAgaWRWaXJ0dWFsOiBsYXN0SXRlbS5sZW5ndGggPiAwID8gbGFzdEl0ZW1bMF0uaWRWaXJ0dWFsICsgMSA6IDAsDQogICAgICAgIH0pDQogICAgICB9IGVsc2Ugew0KICAgICAgICBsZXQgZWRpdGVkSXRlbSA9IHRoaXMucGF5bWVudHMuZmluZCgNCiAgICAgICAgICAoeCkgPT4geC5pZFZpcnR1YWwgPT0gaXRlbS5pZFZpcnR1YWwNCiAgICAgICAgKQ0KICAgICAgICBlZGl0ZWRJdGVtLnZhbHVlID0gaXRlbS52YWx1ZQ0KICAgICAgICBlZGl0ZWRJdGVtLnBheW1lbnRTaXR1YXRpb24gPSBpdGVtLnBheW1lbnRTaXR1YXRpb24NCiAgICAgICAgZWRpdGVkSXRlbS5kYXRlID0gaXRlbS5kYXRlDQogICAgICAgIGVkaXRlZEl0ZW0ucGF5bWVudENhdGVnb3J5ID0gaXRlbS5wYXltZW50Q2F0ZWdvcnkNCiAgICAgICAgZWRpdGVkSXRlbS5leHBlY3RlZERhdGUgPSBpdGVtLmV4cGVjdGVkRGF0ZQ0KICAgICAgfQ0KDQogICAgICB0aGlzLnJlZnJlc2hUb3RhbFZhbHVlKCkNCiAgICB9LA0KICB9LA0KICBjb21wb25lbnRzOiB7DQogICAgRmluYW5jaWFsTW9kYWxVcGRhdGVDcmVhdGUsDQogICAgTG9hZGluZywNCiAgICBDYXRlZ29yeUNoaXAsDQogICAgTWlzc2luZ1Blcm1pc3Npb25Nb2RhbCwNCiAgfSwNCn0NCg=="},{"version":3,"sources":["ProformaFinancial.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAoFA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"ProformaFinancial.vue","sourceRoot":"src/views/proformas/financeiro","sourcesContent":["<template>\r\n  <div style=\"height: 500px\">\r\n    <financial-modal-update-create\r\n      ref=\"financialModal\"\r\n      @on-save=\"saveFinancialItem\"\r\n    />\r\n    <MissingPermissionModal \r\n      ref=\"missingPermissionModal\"\r\n    />\r\n    <div class=\"flex-grow d-flex justify-end\">\r\n      <v-btn\r\n        v-if=\"!readonly\"\r\n        rounded\r\n        large\r\n        class=\"asia-yellow secondaryAction--text var-1 mr-2 font-weight-bold\"\r\n        @click=\"createItem()\"\r\n      >\r\n        + ADICIONAR PAGAMENTO\r\n      </v-btn>\r\n    </div>\r\n    <div\r\n      style=\"overflow: auto; height: 450px\"\r\n      class=\"rounded-lg pa-2 white elevation-5 mt-5\"\r\n    >\r\n      <v-data-table\r\n        ref=\"paymentsTable\"\r\n        class=\"elevation-1 mt-5\"\r\n        disable-sort\r\n        :headers=\"readonly ? headersFinanceiro.filter(x => x.value != 'idVirtual') : headersFinanceiro\"\r\n        :items=\"payments\"\r\n        noDataText=\"Nenhum registro encontrado\"\r\n        hide-default-footer\r\n        :options.sync=\"options\"\r\n      >\r\n        <template v-slot:[`body.append`]=\"{ headers }\">\r\n          <tr>\r\n            <td :colspan=\"headers.length\">\r\n              Valor total {{ totalValue | currencyFormat }}\r\n            </td>\r\n          </tr>\r\n        </template>\r\n        <template v-slot:[`item.idVirtual`]=\"{ item }\">\r\n          <v-btn icon @click=\"updateItem(item.idVirtual)\">\r\n            <v-icon> mdi-pencil </v-icon>\r\n          </v-btn>\r\n          <v-btn icon @click=\"deleteItem(item.idVirtual)\">\r\n            <v-icon> mdi-delete </v-icon>\r\n          </v-btn>\r\n        </template>\r\n\r\n        <template v-slot:[`item.expectedDate`]=\"{ item }\">\r\n          {{ item.expectedDate | dateFormat }}\r\n        </template>\r\n        <template v-slot:[`item.date`]=\"{ item }\">\r\n          {{ item.date | dateFormat }}\r\n        </template>\r\n\r\n        <template v-slot:[`item.value`]=\"{ item }\">\r\n          {{ item.value | currencyFormat }}\r\n        </template>\r\n\r\n        <template v-slot:[`item.paymentCategory`]=\"{ item }\">\r\n          <Loading :startContent=\"true\" v-if=\"!item.paymentCategory\" />\r\n          <category-chip\r\n            v-else-if=\"item.paymentCategory\"\r\n            :color=\"item.paymentCategory.color\"\r\n            :text=\"item.paymentCategory.description\"\r\n          />\r\n        </template>\r\n\r\n        <template v-slot:[`item.paymentSituation`]=\"{ item }\">\r\n          <Loading :startContent=\"true\" v-if=\"!item.paymentSituation\" />\r\n          <category-chip\r\n            v-else-if=\"item.paymentSituation\"\r\n            :color=\"item.paymentSituation.color\"\r\n            :text=\"item.paymentSituation.description\"\r\n          />\r\n        </template>\r\n      </v-data-table>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport CategoryChip from '@/components/CategoryChip.vue'\r\nimport Loading from '@/components/Loading.vue'\r\nimport FinancialModalUpdateCreate from './FinancialModalUpdateCreate.vue'\r\nimport MissingPermissionModal from \"@/components/MissingPermissionModal.vue\";\r\n\r\nexport default {\r\n  name: 'ProformaFinancial',\r\n  props: ['value', 'readonly'],\r\n\r\n  data: () => ({\r\n    options: {},\r\n    headersFinanceiro: [\r\n      { text: '', value: 'idVirtual' },\r\n      { text: 'Categoria', value: 'paymentCategory' },\r\n      { text: 'Data Prevista', value: 'expectedDate' },\r\n      { text: 'Data Realizada', value: 'date' },\r\n      { text: 'Valor', value: 'value' },\r\n      { text: 'Situação', value: 'paymentSituation' },\r\n    ],\r\n    payments: [],\r\n    showModal: false,\r\n    totalValue: 0,\r\n  }),\r\n  watch: {\r\n    options: {\r\n      handler() {\r\n        this.payments = this.value.map((item, index) => ({\r\n          ...item,\r\n          idVirtual: index,\r\n        }))\r\n      },\r\n      deep: true,\r\n    },\r\n    payments: {\r\n      deep: true,\r\n      handler() {\r\n        this.$emit('input', this.payments)\r\n      },\r\n    },\r\n  },\r\n  methods: {\r\n    async createItem() {\r\n      if (this.hasPermission(this.$PermissionNames.permissionCategorySituationSee))\r\n        this.$refs.financialModal.showDialog({});\r\n      else\r\n        this.$refs.missingPermissionModal.open();\r\n    },\r\n    deleteItem(currentId) {\r\n      this.payments = this.payments.filter((x) => x.idVirtual != currentId)\r\n      this.refreshTotalValue();\r\n    },\r\n    async updateItem(currentId) {\r\n      this.$refs.financialModal.showDialog({\r\n        ...this.payments.find((x) => x.idVirtual == currentId),\r\n      })\r\n    },\r\n    async refreshTotalValue() {\r\n      this.totalValue =\r\n        this.payments.length > 0\r\n          ? this.payments.map((x) => Number(x.value)).reduce((x, y) => x + y)\r\n          : 0\r\n    },\r\n    saveFinancialItem(item) {\r\n      if (item.idVirtual == -1) {\r\n        let lastItem = this.payments.slice(-1)\r\n        item.paymentSituationId = item.paymentSituation.id\r\n        item.paymentCategoryId = item.paymentCategory.id\r\n        this.payments.push({\r\n          ...item,\r\n          idVirtual: lastItem.length > 0 ? lastItem[0].idVirtual + 1 : 0,\r\n        })\r\n      } else {\r\n        let editedItem = this.payments.find(\r\n          (x) => x.idVirtual == item.idVirtual\r\n        )\r\n        editedItem.value = item.value\r\n        editedItem.paymentSituation = item.paymentSituation\r\n        editedItem.date = item.date\r\n        editedItem.paymentCategory = item.paymentCategory\r\n        editedItem.expectedDate = item.expectedDate\r\n      }\r\n\r\n      this.refreshTotalValue()\r\n    },\r\n  },\r\n  components: {\r\n    FinancialModalUpdateCreate,\r\n    Loading,\r\n    CategoryChip,\r\n    MissingPermissionModal,\r\n  },\r\n}\r\n</script>"]}]}