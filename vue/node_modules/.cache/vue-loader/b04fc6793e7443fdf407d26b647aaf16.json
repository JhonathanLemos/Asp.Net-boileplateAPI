{"remainingRequest":"C:\\Users\\lemos\\OneDrive\\Documentos\\My Web Sites\\7.3.0\\vue\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\lemos\\OneDrive\\Documentos\\My Web Sites\\7.3.0\\vue\\src\\views\\ordemCompra\\entregas\\primeiraEntrega\\PrimeiraEntregaMateriais.vue?vue&type=style&index=0&id=10a96502&scoped=true&lang=css&","dependencies":[{"path":"C:\\Users\\lemos\\OneDrive\\Documentos\\My Web Sites\\7.3.0\\vue\\src\\views\\ordemCompra\\entregas\\primeiraEntrega\\PrimeiraEntregaMateriais.vue","mtime":1680609356658},{"path":"C:\\Users\\lemos\\OneDrive\\Documentos\\My Web Sites\\7.3.0\\vue\\node_modules\\css-loader\\dist\\cjs.js","mtime":1683229778387},{"path":"C:\\Users\\lemos\\OneDrive\\Documentos\\My Web Sites\\7.3.0\\vue\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1683229781560},{"path":"C:\\Users\\lemos\\OneDrive\\Documentos\\My Web Sites\\7.3.0\\vue\\node_modules\\postcss-loader\\src\\index.js","mtime":1683229779724},{"path":"C:\\Users\\lemos\\OneDrive\\Documentos\\My Web Sites\\7.3.0\\vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1683229777571},{"path":"C:\\Users\\lemos\\OneDrive\\Documentos\\My Web Sites\\7.3.0\\vue\\node_modules\\vue-loader\\lib\\index.js","mtime":1683229780390}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCg0KLnYtaW5wdXQtLXNlbGVjdGlvbi1jb250cm9sc19faW5wdXQgew0KICBtYXJnaW4tbGVmdDogMTBweCAhaW1wb3J0YW50Ow0KfQ0KDQoudi1pbnB1dC0tc2VsZWN0aW9uLWNvbnRyb2xzX19pbnB1dCAudi1pY29uIHsNCiAgZm9udC1zaXplOiAyMHB4ICFpbXBvcnRhbnQ7DQp9DQo="},{"version":3,"sources":["PrimeiraEntregaMateriais.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAqYA;AACA;AACA;;AAEA;AACA;AACA","file":"PrimeiraEntregaMateriais.vue","sourceRoot":"src/views/ordemCompra/entregas/primeiraEntrega","sourcesContent":["<template>\r\n  <div>\r\n    <v-dialog v-model=\"dialogAvisoDelete\" max-width=\"360px\">\r\n      <div class=\"white pa-5 d-flex flex-column align-center text-center\">\r\n        <v-icon style=\"font-size: 60px\" color=\"#F75A02\">\r\n          mdi-alert-octagon\r\n        </v-icon>\r\n\r\n        <h4\r\n          class=\"asia-neutral--text text--var-1 mb-8 mt-8\"\r\n          style=\"font-size: 15px\"\r\n        >\r\n          A <span style=\"font-weight: bold\">Quantidade Faturada </span> é\r\n          <span style=\"font-weight: bold\"> diferente</span> da\r\n          <span style=\"font-weight: bold\">Quantidade Provisionada.</span> Deseja\r\n          prosseguir?\r\n        </h4>\r\n\r\n        <div class=\"d-flex flex-row justify-end\">\r\n          <v-btn\r\n            rounded\r\n            large\r\n            class=\"ml-3\"\r\n            text\r\n            @click=\"dialogAvisoDelete = false\"\r\n            >CANCELAR</v-btn\r\n          >\r\n          <v-btn\r\n            style=\"background: #f75a02\"\r\n            dark\r\n            rounded\r\n            large\r\n            text\r\n            class=\"mr-4\"\r\n            @click=\"updateDeliveryMaterial\"\r\n            >PROSSEGUIR</v-btn\r\n          >\r\n        </div>\r\n      </div>\r\n    </v-dialog>\r\n    <div\r\n      class=\"flex-grow-1 rounded-lg pa-4 white elevation-2 mt-2 ml-1 mr-1 mb-2\"\r\n      style=\"overflow: hidden\"\r\n    >\r\n      <!-- Data Table -->\r\n      <v-data-table\r\n        disable-sort\r\n        :headers=\"isDistribution ? headersDistribution : headers\"\r\n        :items=\"rows\"\r\n        :loading=\"tableLoading\"\r\n        noDataText=\"Nenhum registro encontrado\"\r\n        loading-text=\"Aguarde, carregando materiais...\"\r\n        :footer-props=\"{\r\n          itemsPerPageOptions: [10, 50, 100],\r\n          itemsPerPageText: 'Itens por Página',\r\n        }\"\r\n      >\r\n        <!-- Icone Edição -->\r\n        <template v-slot:[`item.col1`]=\"{ item }\">\r\n          <div class=\"d-flex flex-nowrap align-center\">\r\n            <v-checkbox\r\n              @click=\"\r\n                item.col1 ? getMaterialToUpdate(item.col9) : setFalse(item.col9)\r\n              \"\r\n              :disabled=\"!editPermission\"\r\n              v-model=\"item.col1\"\r\n              :value=\"item.col1\"\r\n              color=\"asia-red\"\r\n            ></v-checkbox>\r\n            <v-btn\r\n              v-if=\"item.col1\"\r\n              icon\r\n              @click=\"getMaterialToUpdate(item.col9)\"\r\n            >\r\n              <v-icon>mdi-pencil</v-icon>\r\n            </v-btn>\r\n          </div>\r\n        </template>\r\n\r\n        <template v-slot:[`item.col6`]=\"{ item }\">\r\n          {{ item.col6 + \" kg\" }}\r\n        </template>\r\n\r\n        <template v-slot:[`item.col7`]=\"{ item }\">\r\n          <div v-if=\"currency == 'R$' && item.col7\">\r\n            {{ item.col7 | currencyFormatReal }}\r\n          </div>\r\n          <div v-if=\"currency == 'USD' && item.col7\">\r\n            {{ item.col7 | currencyFormat }}\r\n          </div>\r\n          <div v-else></div>\r\n        </template>\r\n\r\n        <template v-slot:[`item.col8`]=\"{ item }\">\r\n          <div v-if=\"currency == 'USD'\">\r\n            {{ item.col8 | currencyFormat }}\r\n          </div>\r\n          <div v-else-if=\"currency == 'R$'\">\r\n            {{ item.col8 | currencyFormatReal }}\r\n          </div>\r\n        </template>\r\n        <template v-slot:[`item.col9`]> </template>\r\n\r\n        <template v-slot:[`body.append`]>\r\n          <div class=\"d-flex align-center mt-2 mb-2\" style=\"width: 240%\">\r\n            <span class=\"mr-4\" style=\"font-size: 14px; font-weight: 700\"\r\n              >Valor total dos materiais:</span\r\n            >\r\n            <h3 style=\"font-size: 16px; font-weight: 400\">\r\n              <div v-if=\"currency == 'USD'\">\r\n                {{ valorTotalMaterial | currencyFormat }}\r\n              </div>\r\n              <div v-else-if=\"currency == 'R$'\">\r\n                {{ valorTotalMaterial | currencyFormatReal }}\r\n              </div>\r\n            </h3>\r\n          </div>\r\n        </template>\r\n      </v-data-table>\r\n    </div>\r\n\r\n    <!-- MODAL EDIT -->\r\n    <v-dialog v-model=\"modalEditMaterial\" max-width=\"800px\">\r\n      <v-form ref=\"form\">\r\n        <div class=\"white pa-4 d-flex flex-column\">\r\n          <div class=\"d-flex justify-space-between\">\r\n            <h2 class=\"asia-neutral--text text--var-1 ml-2\">Material</h2>\r\n\r\n            <v-btn icon text @click=\"closeModalAndReset\">\r\n              <v-icon> mdi-close </v-icon>\r\n            </v-btn>\r\n          </div>\r\n\r\n          <v-divider></v-divider>\r\n\r\n          <div class=\"d-flex my-6 ml-4\" style=\"width: 100%\">\r\n            <v-input\r\n              style=\"width: 50%\"\r\n              label=\"Material\"\r\n              :messages=\"\r\n                infoMaterials.materialName ? infoMaterials.materialName : ''\r\n              \"\r\n            ></v-input>\r\n\r\n            <v-input\r\n              style=\"width: 50%\"\r\n              label=\"Quantidade Provisionada\"\r\n              :messages=\"\r\n                infoMaterials.provisionedQtd\r\n                  ? infoMaterials.provisionedQtd.toString()\r\n                  : ''\r\n              \"\r\n            ></v-input>\r\n          </div>\r\n\r\n          <div class=\"d-flex my-6 ml-4\" style=\"width: 100%\">\r\n            <div style=\"width: 50%\">\r\n              <v-radio-group v-model=\"infoMaterials.radio\">\r\n                <v-radio\r\n                  :rules=\"[rules.required]\"\r\n                  class=\"mb-4\"\r\n                  color=\"asia-red\"\r\n                  :value=\"false\"\r\n                  label=\"Quantidade total do material\"\r\n                ></v-radio>\r\n\r\n                <v-radio\r\n                  color=\"asia-red\"\r\n                  :value=\"true\"\r\n                  :rules=\"[rules.required]\"\r\n                  label=\"Quantidade parcial do material\"\r\n                ></v-radio>\r\n              </v-radio-group>\r\n            </div>\r\n\r\n            <v-text-field\r\n              class=\"mr-4\"\r\n              style=\"width: 48%\"\r\n              label=\"Quantidade Faturada\"\r\n              :rules=\"[rules.required]\"\r\n              v-model=\"infoMaterials.billedAmount\"\r\n            ></v-text-field>\r\n          </div>\r\n\r\n          <v-divider></v-divider>\r\n\r\n          <div class=\"d-flex flex-row justify-end mt-3\">\r\n            <v-btn\r\n              rounded\r\n              class=\"asia-red white--text\"\r\n              :loading=\"loadingBtnSave\"\r\n              @click=\"validateBilledAmount\"\r\n              >SALVAR</v-btn\r\n            >\r\n          </div>\r\n        </div>\r\n      </v-form>\r\n    </v-dialog>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport validationRules from \"../../../../mixins/validationRules\";\r\nimport { createNamespacedHelpers } from \"vuex\";\r\nconst moduleDeliveryMaterials = createNamespacedHelpers(\r\n  \"ModuleDeliveryMaterials\"\r\n);\r\nexport default {\r\n  props: [\"value\", \"currency\", \"isDistribution\"],\r\n  data: () => ({\r\n    headersDistribution: [\r\n      { text: \"Faturado\", value: \"col1\", width: \"5%\" },\r\n      { text: \"Código\", value: \"col2\", width: \"10%\" },\r\n      { text: \"Descrição\", value: \"col3\", width: \"32%\" },\r\n      { text: \"Provisionada\", value: \"col4\", width: \"10%\" },\r\n      { text: \"Faturada\", value: \"col5\", width: \"10%\" },\r\n      { text: \"Saldo do Material\", value: \"col6\", width: \"13%\" },\r\n      { text: \"Valor Unitário\", value: \"col7\", width: \"10%\" },\r\n      { text: \"Valor Total\", value: \"col8\", width: \"10%\" },\r\n      { text: \"\", value: \"col9\", width: \"\" },\r\n    ],\r\n    headers: [\r\n      { text: \"Faturado\", value: \"col1\", width: \"5%\" },\r\n      { text: \"Código\", value: \"col2\", width: \"10%\" },\r\n      { text: \"Descrição\", value: \"col3\", width: \"30%\" },\r\n      { text: \"Embarcado O.C.\", value: \"col4\", width: \"12%\" },\r\n      { text: \"Faturada\", value: \"col5\", width: \"10%\" },\r\n      { text: \"Saldo do Material\", value: \"col6\", width: \"13%\" },\r\n      { text: \"Valor Unitário\", value: \"col7\", width: \"10%\" },\r\n      { text: \"Valor Total\", value: \"col8\", width: \"10%\" },\r\n      { text: \"\", value: \"col9\", width: \"\" },\r\n    ],\r\n    rows: [],\r\n    loadingBtnSave: null,\r\n    list: [],\r\n    dialogAvisoDelete: null,\r\n    materialsList: [],\r\n    modalEditMaterial: false,\r\n    materialsListToUpdate: [],\r\n    valorTotalMaterial: null,\r\n    infoMaterials: {\r\n      radio: false,\r\n    },\r\n    tableLoading: true,\r\n  }),\r\n\r\n  methods: {\r\n    ...moduleDeliveryMaterials.mapActions({\r\n      getById: \"getById\",\r\n      setToFalseById: \"setToFalseById\",\r\n      updateMaterial: \"update\",\r\n      getAllByDelivery: \"getAllByDelivery\",\r\n    }),\r\n\r\n    async setFalse(id) {\r\n      if (!this.infoMaterials.isNew) {\r\n        this.valorTotalMaterial = null;\r\n        await this.setToFalseById(id);\r\n      } else {\r\n        this.infoMaterials.isBilled = false;\r\n      }\r\n    },\r\n\r\n    validateBilledAmount() {\r\n      if (\r\n        this.infoMaterials.provisionedQtd != this.infoMaterials.billedAmount\r\n      ) {\r\n        this.dialogAvisoDelete = true;\r\n        return;\r\n      } else {\r\n        this.updateDeliveryMaterial();\r\n        this.dialogAvisoDelete = false;\r\n      }\r\n    },\r\n\r\n    buildRows(data) {\r\n      if (!data || data.length == 0) {\r\n        this.rows = [];\r\n        return;\r\n      }\r\n      this.valorTotalMaterial = null;\r\n      this.materialsList.forEach((element) => {\r\n        var teste = element.billedAmount * element.unitaryValue;\r\n        this.valorTotalMaterial = this.valorTotalMaterial + teste;\r\n      });\r\n      this.rows = data.map((e) => ({\r\n        col1: e.isBilled,\r\n        col2: e.materialCode,\r\n        col3: e.materialName,\r\n        col4: this.isDistribution\r\n          ? `${e.provisionedQtd} kg`\r\n          : `${e.shippedQuantity} kg`,\r\n        col5: `${e.billedAmount} kg`,\r\n        col6: e.balance,\r\n        col7: e.unitaryValue,\r\n        col8:\r\n          e.billedAmount && e.unitaryValue\r\n            ? e.billedAmount * e.unitaryValue\r\n            : 0,\r\n        col9: e.id,\r\n      }));\r\n    },\r\n\r\n    async getMaterialToUpdate(id) {\r\n      var item = this.materialsList.filter((x) => x.id == id)[0];\r\n      var response = await this.getById(id);\r\n\r\n      if (!item.isNew) {\r\n        if (response.status == 200 && response.data.result) {\r\n          this.infoMaterials = response.data.result;\r\n          this.infoMaterials.isBilled = true;\r\n          this.modalEditMaterial = true;\r\n        }\r\n      } else {\r\n        this.infoMaterials = item;\r\n        this.infoMaterials.radio = false;\r\n        this.modalEditMaterial = true;\r\n      }\r\n    },\r\n\r\n    closeModalAndReset() {\r\n      this.modalEditMaterial = false;\r\n      this.materialsList = this.materialsListToUpdate;\r\n      this.buildRows(this.materialsList);\r\n      this.tableLoading = false;\r\n    },\r\n\r\n    async updateDeliveryMaterial() {\r\n      this.dialogAvisoDelete = false;\r\n      this.loadingBtnSave = true;\r\n      if (this.infoMaterials.isNew) {\r\n        this.infoMaterials.isBilled = true;\r\n\r\n        var index = this.materialsList\r\n          .map((object) => object.id)\r\n          .indexOf(this.infoMaterials.id);\r\n        this.materialsList.splice(index, this.infoMaterials);\r\n        this.modalEditMaterial = false;\r\n      } else {\r\n        var response = await this.updateMaterial(this.infoMaterials);\r\n        if (response.status == 200) {\r\n          this.modalEditMaterial = false;\r\n          this.$emit(\"success\", \"Entrega salva com sucesso!\");\r\n          var responseDelivery = await this.getAllByDelivery(\r\n            this.infoMaterials.purchaseDeliveryId\r\n          );\r\n          this.materialsList = responseDelivery.data.result;\r\n          this.buildRows(this.materialsList);\r\n        }\r\n      }\r\n      this.loadingBtnSave = false;\r\n    },\r\n  },\r\n\r\n  watch: {\r\n    value(newValue) {\r\n      this.materialsListToUpdate = newValue;\r\n      this.materialsList = newValue;\r\n      this.buildRows(this.materialsList);\r\n      this.tableLoading = false;\r\n    },\r\n\r\n    materialsList: {\r\n      deep: true,\r\n      handler() {\r\n        this.valorTotalMaterial = null;\r\n        this.materialsList.forEach((element) => {\r\n          var teste = element.billedAmount * element.unitaryValue;\r\n          this.valorTotalMaterial = this.valorTotalMaterial + teste;\r\n        });\r\n        this.$emit(\"input\", this.materialsList);\r\n        this.tableLoading = false;\r\n      },\r\n    },\r\n  },\r\n\r\n  computed: {\r\n    editPermission() {\r\n      return this.hasPermission(\r\n        this.$PermissionNames.permissionPurchaseOrderEdit\r\n      );\r\n    },\r\n  },\r\n\r\n  mixins: [validationRules],\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.v-input--selection-controls__input {\r\n  margin-left: 10px !important;\r\n}\r\n\r\n.v-input--selection-controls__input .v-icon {\r\n  font-size: 20px !important;\r\n}\r\n</style>\r\n"]}]}